<?php
require_once 'simpletest/autorun.php';
require_once 'NDAR_Release.class.inc';

Mock::GeneratePartial('NDAR_Release', 'NDAR_Release_Partial', array('getQuery', 'process', 'writeResults'));

class TestOfNDARScript extends UnitTestCase {
    function setUp() {
        $this->factory = NDB_Factory::singleton();
        $this->factory->setTesting(true);
        $this->db = $this->factory->Database();
        $this->CommonCandidateFields = 'c.IBISID, s.Visit_label, CASE s.SubprojectID WHEN 1 THEN \'High Risk\' WHEN 2 THEN \'High Risk\' WHEN 3 THEN \'Control\' END as Cohort, c.CandidateGUID, c.DoB, c.Gender, ROUND(DATEDIFF(i.Date_taken, c.DoB) / (365/12)) AS Candidate_Age_in_Months,';
        $this->CommonProbandFields = 'c.IBISID, s.Visit_label, CASE s.SubprojectID WHEN 1 THEN \'High Risk\' WHEN 2 THEN \'High Risk\' WHEN 3 THEN \'Control\' END as Cohort, c.ProbandGUID, c.ProbandDoB, c.ProbandGender, ROUND(DATEDIFF(i.Date_taken, c.ProbandDoB) / (365/12)) AS Proband_Age_in_Months,';

    }
    function tearDown() {
        $this->factory->reset();
    }

    function testExists() {
        $ndar = new NDAR_Release('adi_r_proband');
        $this->assertEqual($ndar->instrument, 'adi_r_proband');
        //$this->assertTrue($ndar->run());
    }

    function testGetWhere() {
        $ndar = new NDAR_Release('adi_r_proband');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND i.Summary_diagnosis='ASD+'");
        $ndar = new NDAR_Release('aosi');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
        $ndar = new NDAR_Release('seq');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
        $ndar = new NDAR_Release('m_chat_proband');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND s.SubprojectID <> 3 AND i.score='Fail'");
        $ndar = new NDAR_Release('mullen');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
        $ndar = new NDAR_Release('scq_proband');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND s.SubprojectID IN (1, 2) AND i.scq_diagnosis='ASD Positive'");
        $ndar = new NDAR_Release('scq_subject');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND s.SubprojectID=3 AND UPPER(s.Visit_label)='V24'");
        $ndar = new NDAR_Release('vineland_proband');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND s.CenterID IN (2, 3, 4, 5) AND s.SubprojectID IN (1, 2)");
        $ndar = new NDAR_Release('vineland_subject');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')) OR (s.SubprojectID=1 AND UPPER(s.Visit_label)='V06'))");
        $ndar = new NDAR_Release('rbs_r');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
        $ndar = new NDAR_Release('macarthur_words_gestures');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
        $ndar = new NDAR_Release('csbs');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
        $ndar = new NDAR_Release('ibq_r');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
        $ndar = new NDAR_Release('head_measurements_subject');
        $this->assertEqual($ndar->getWhere(), "COALESCE(s.Current_stage, '') <> 'Recycling Bin' AND COALESCE(s.Visit, '') NOT IN ('Failure', 'Withdrawal') AND COALESCE(s.Screening, '') NOT IN ('Failure', 'Withdrawal') AND f.Administration='All' AND f.Data_entry='Complete' AND EXISTS (SELECT 'x' FROM flag df WHERE df.CommentID=CONCAT('DDE_', i.CommentID) AND df.Data_entry='Complete') AND NOT EXISTS (SELECT 'x' FROM conflicts_unresolved cu WHERE cu.CommentId1=i.CommentID OR cu.CommentId2=i.CommentID) AND s.CenterID IN (2, 3, 4, 5) AND ((s.SubprojectID=1 AND UPPER(s.Visit_label)='V06') OR (s.SubprojectID=3 AND UPPER(s.Visit_label) IN ('V06', 'V12', 'V24')))");
    }

    function testADIRFields() {
        $fields = array(
            'A_Total',
            'BNV_Total',
            'BV_Total',
            'C_Total',
            'D_Total',
            'Total_A1',
            'Total_A2',
            'Total_A3',
            'Total_A4',
            'Total_B1',
            'Total_B2V',
            'Total_B3V',
            'Total_B4',
            'Total_C1',
            'Total_C2',
            'Total_C3',
            'Total_C4',
            'summary_diagnosis',
            'informant_relation',
            'q_2_age_first_noticed_code',
            'q_4_onset_as_perceived_code',
            'q_5_first_walked_code',
            'q_6_bladder_daytime_code',
            'q_7_bladder_nighttime_code',
            'q_8_bowel_control_code',
            'q_9_first_single_words_code',
            'q_10_first_phrases_code',
            'q_11_loss_of_language',
            'q_12_level_before_loss_code',
            'q_13_loss_of_spontaneous_use_code',
            'q_14_loss_of_intent_code',
            'q_15_loss_of_syntactical_code',
            'q_16_loss_of_articulation_code',
            'q_17_main_loss_apparent_code',
            'q_18_loss_due_to_illness',
            'q_19_duration_of_loss_code',
            'q_20_loss_of_skills_code',
            'q_21_puposive_hand_movements_code',
            'q_22_motor_skills_code',
            'q_23_self_help_skills_code',
            'q_24_constructive_play_code',
            'q_25_social_engagement_code',
            'q_26_loss_first_apparent_code',
            'q_27_physical_illness_code',
            'q_28_duration_of_loss_code',
            'q_29_compreh_simple_current',
            'q_29_compreh_simple_most_abnormal',
            'q_30_overall_level_of_language',
            'q_31_use_of_others_body_current_code',
            'q_31_use_of_others_body_ever_code ',
            'q_32_artic_pronun_5years_code',
            'q_32_artic_pronun_current_code',
            'q_33_stereotyped_utterances_current_code',
            'q_33_stereotyped_utterances_ever_code',
            'q_34_social_verb_chat_current_code',
            'q_34_social_verb_chat_ever_code',
            'q_35_recipr_convers_current_code',
            'q_35_recipr_convers_ever_code',
            'q_36_inappropriate_qs_current_code',
            'q_36_inappropriate_qs_ever_code',
            'q_37_prenominal_reversal_current_code',
            'q_37_prenominal_reversal_ever_code',
            'q_38_neologisms_current_code',
            'q_38_neologisms_ever_code',
            'q_39_verbal_rituals_current_code',
            'q_39_verbal_rituals_ever_code',
            'q_40_inton_vol_rhythm_rate_current_code',
            'q_40_inton_vol_rhythm_rate_ever_code',
            'q_41_cur_comm_speech_at5_code',
            'q_41_cur_comm_speech_current_code',
            'q_42_point_express_inter_most_abnormal_code',
            'q_42_point_express_interest_current_code',
            'q_43_nodding_current_code',
            'q_43_nodding_most_abnormal_code',
            'q_44_head_shaking_current_code',
            'q_44_head_shaking_most_abnormal_code',
            'q_45_conventional_instr_gests_current_code',
            'q_45_conventional_instr_gests_most_abnormal_code',
            'q_46_attent_voice_current_code',
            'q_46_attent_voice_most_abnormal_code',
            'q_47_spont_imit_current_code',
            'q_47_spont_imit_most_abnormal_code',
            'q_48_imag_play_current_code',
            'q_48_imag_play_most_abnormal_code',
            'q_49_imag_play_peers_current_code',
            'q_49_imag_play_peers_most_abnormal_code',
            'q_50_direct_gaze_current_code',
            'q_50_direct_gaze_most_abnormal_code',
            'q_51_social_smiling_current_code',
            'q_51_social_smiling_most_abnormal_code',
            'q_52_show_direct_atten_current_code',
            'q_52_show_direct_atten_most_abnormal_code',
            'q_53_offer_share_current_code',
            'q_53_offer_share_most_abnormal_code',
            'q_54_seek_share_enjoy_current_code',
            'q_54_seek_share_enjoy_most_abnormal_code',
            'q_55_offer_comf_current_code',
            'q_55_offer_comf_most_abnormal_code',
            'q_56_qual_social_overts_current_code',
            'q_56_qual_social_overts_most_abnormal_code',
            'q_57_range_facial_expr_current_code',
            'q_57_range_facial_expr_most_abnormal_code',
            'q_58_inappropriate_facial_current_code',
            'q_58_inappropriate_facial_ever_code',
            'q_59_appropriat_resp_current_code',
            'q_59_appropriat_resp_most_abnormal_code',
            'q_60_init_activities_current_code',
            'q_60_init_activities_most_abnormal_code',
            'q_61_imit_soc_play_current_code',
            'q_61_imit_soc_play_most_abnormal_code',
            'q_62_inter_children_current_code',
            'q_62_inter_children_most_abnormal_code',
            'q_63_resp_approaches_current_code',
            'q_63_resp_approaches_most_abnormal_code',
            'q_64_group_play_peers_current_code',
            'q_64_group_play_peers_most_abnormal_code',
            'q_65_friendships_current_code',
            'q_65_friendships_most_abnormal_code',
            'q_66_soc_disinhibit_current_code',
            'q_66_soc_disinhibit_most_abnormal_code',
            'q_67_unusual_preoccupations_current_code',
            'q_67_unusual_preoccupations_ever_code',
            'q_68_circumscr_ints_current_code',
            'q_68_circumscr_ints_ever_code',
            'q_69_repet_use_objects_current_code',
            'q_69_repet_use_objects_ever_code',
            'q_70_compulsions_rituals_current_code',
            'q_70_compulsions_rituals_ever_code',
            'q_71_unusual_sens_ints_current_code',
            'q_71_unusual_sens_ints_ever_code',
            'q_72_undo_gen_sens_noise_current_code',
            'q_72_undo_gen_sens_noise_ever_code',
            'q_73_idiosyncratic_current_code',
            'q_73_idiosyncratic_ever_code',
            'q_74_diff_minor_changes_current_code',
            'q_74_diff_minor_changes_ever_code',
            'q_75_resist_trivial_chng_current_code',
            'q_75_resist_trivial_chng_ever_code',
            'q_76_unus_attach_objects_current_code',
            'q_76_unus_attach_objects_ever_code',
            'q_77_hands_finger_manners_current_code',
            'q_77_hands_finger_manners_ever_code',
            'q_78_oth_complex_manners_current_code',
            'q_78_oth_complex_manners_ever_code',
            'q_79_midline_hand_moves_current_code',
            'q_79_midline_hand_moves_ever_code',
            'q_80_gait_current_code',
            'q_80_gait_most_abnormal_code',
            'q_81_aggress_caregivers_current_code',
            'q_81_aggress_caregivers_ever_code',
            'q_82_aggress_noncaregivers_current_code',
            'q_82_aggress_noncaregivers_ever_code',
            'q_83_self_injury_current_code',
            'q_83_self_injury_ever_code',
            'q_84_hyperventilation_current_code',
            'q_84_hyperventilation_ever_code',
            'q_85_faints_fits_blackouts_current_code',
            'q_85_faints_fits_blackouts_ever_code',
            'q_86_age_when_abnormality_first_evident',
            'q_87_interviewers_judgment',
            'q_88_visuospatial_ability_current_code',
            'q_88_visuospatial_ability_ever_code',
            'q_89_memory_still_current_code',
            'q_89_memory_still_ever_code',
            'q_90_musical_ability_current_code',
            'q_90_musical_ability_ever_code',
            'q_91_drawings_skill_current_code',
            'q_91_drawings_skill_ever_code',
            'q_92_reading_ability_current_code',
            'q_92_reading_ability_ever_code',
            'q_93_computational_ability_current_code',
            'q_93_computational_ability_ever_code'
        );
        $ndar = new NDAR_Release('adi_r_proband');
        $this->assertEqual($ndar->getFields(), $this->CommonProbandFields . ' f.Validity, i.Date_taken, i.' . implode($fields, ", i."));
    }

    function testAOSIFields() {
        $fields = array(
            'examiner_location',
            'total_score_1_18_override',
            'number_of_markers_override',
            'q1_visual_tracking_score_override',
            'q1_visual_tracking_notes',
            'q1_visual_tracking_notes_status',
            'q2_disengagement_of_attention_score_override',
            'q2_disengagement_of_attention_notes',
            'q2_disengagement_of_attention_notes_status',
            'free_play_period_1_notes',
            'free_play_period_1_notes_status',
            'q3_orients_to_name_score_override',
            'q3_orients_to_name_notes',
            'q3_orients_to_name_notes_status',
            'q4_differential_response_to_facial_emotion',
            'q4_differential_response_to_facial_emotion_notes',
            'q4_differential_response_to_facial_emotion_notes_status',
            'q5_anticipatory_response',
            'q5_anticipatory_response_notes',
            'q5_anticipatory_response_notes_status',
            'q6_imitation_of_actions_score_override',
            'q6_imitation_of_actions_notes',
            'q6_imitation_of_actions_notes_status',
            'free_play_period_2_notes',
            'free_play_period_2_notes_status',
            'q7_social_babbling',
            'q7_social_babbling_notes',
            'q7_social_babbling_notes_status',
            'q8_eye_contact',
            'q8_eye_contact_notes',
            'q8_eye_contact_notes_status',
            'q9_reciprocal_social_smile',
            'q9_reciprocal_social_smile_notes',
            'q9_reciprocal_social_smile_notes_status',
            'q10_coordination_of_eye_gaze_and_action',
            'q10_coordination_of_eye_gaze_and_action_notes',
            'q10_coordination_of_eye_gaze_and_action_notes_status',
            'q11_reactivity',
            'q11_reactivity_notes',
            'q11_reactivity_notes_status',
            'q14_social_interest',
            'q14_social_interest_notes',
            'q14_social_interest_notes_status',
            'q15_transitions',
            'q15_transitions_notes',
            'q15_transitions_notes_status',
            'q16_motor_control_and_behaviour',
            'q16_motor_control_and_behaviour_notes',
            'q16_motor_control_and_behaviour_notes_status',
            'q17_atypical_motor',
            'q17_atypical_motor_notes',
            'q17_atypical_motor_notes_status',
            'q18_atypical_sensory',
            'q18_atypical_sensory_notes',
            'q18_atypical_sensory_notes_status',
            'q19_engagement_of_attention',
            'q19_engagement_of_attention_notes',
            'q19_engagement_of_attention_notes_status',
            'q20_insistence_on_particular_objects',
            'q20_insistence_on_particular_objects_notes',
            'q20_insistence_on_particular_objects_notes_status',
            'q21_social_referencing',
            'q21_social_referencing_notes',
            'q21_social_referencing_notes_status'
        );
        $ndar = new NDAR_Release('aosi');
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' f.Validity, i.Date_taken, i.' . implode($fields, ", i."));
    }

    function testSEQFields() {
        $fields = array(
            'Candidate_Age',
            'person_completing',
            'person_completing_other',
            'q1_react_sensitively',
            'q1_react_sensitively_change',
            'q1_react_sensitively_what_do',
            'q1_react_sensitively_what_do_status',
            'q2_enjoy_music',
            'q2_enjoy_music_change',
            'q2_enjoy_music_what_do',
            'q2_enjoy_music_what_do_status',
            'q3_ignore_call',
            'q3_ignore_call_change',
            'q3_ignore_call_what_do',
            'q3_ignore_call_what_do_status',
            'q4_ignore_tune_out',
            'q4_ignore_tune_out_change',
            'q4_ignore_tune_out_what_do',
            'q4_ignore_tune_out_what_do_status',
            'q5_notive_sounds',
            'q5_notive_sounds_change',
            'q5_notive_sounds_what_do',
            'q5_notive_sounds_what_do_status',
            'q6_show_distress_loud',
            'q6_show_distress_loud_change',
            'q6_show_distress_loud_what_do',
            'q6_show_distress_loud_what_do_status',
            'q7_enjoy_picture_books',
            'q7_enjoy_picture_books_change',
            'q7_enjoy_picture_books_what_do',
            'q7_enjoy_picture_books_what_do_status',
            'q8_disturbed_by_light',
            'q8_disturbed_by_light_change',
            'q8_disturbed_by_light_what_do',
            'q8_disturbed_by_light_what_do_status',
            'q9_stare_at_lights',
            'q9_stare_at_lights_change',
            'q9_stare_at_lights_what_do',
            'q9_stare_at_lights_what_do_status',
            'q10_slow_to_notice',
            'q10_slow_to_notice_change',
            'q10_slow_to_notice_what_do',
            'q10_slow_to_notice_what_do_status',
            'q11_avoid_looking',
            'q11_avoid_looking_change',
            'q11_avoid_looking_what_do',
            'q11_avoid_looking_what_do_status',
            'q12_seem_to_ignore',
            'q12_seem_to_ignore_change',
            'q12_seem_to_ignore_what_do',
            'q12_seem_to_ignore_what_do_status',
            'q13_enjoy_watching_videos',
            'q13_enjoy_watching_videos_change',
            'q13_enjoy_watching_videos_what_do',
            'q13_enjoy_watching_videos_what_do_status',
            'q14_dislike_cuddling',
            'q14_dislike_cuddling_change',
            'q14_dislike_cuddling_what_do',
            'q14_dislike_cuddling_what_do_status',
            'q15_show_distress_grooming',
            'q15_show_distress_grooming_change',
            'q15_show_distress_grooming_what_do',
            'q15_show_distress_grooming_what_do_status',
            'q16_avoid_touching',
            'q16_avoid_touching_change',
            'q16_avoid_touching_what_do',
            'q16_avoid_touching_what_do_status',
            'q17_react_negatively',
            'q17_react_negatively_change',
            'q17_react_negatively_what_do',
            'q17_react_negatively_what_do_status',
            'q18_trouble_adjusting',
            'q18_trouble_adjusting_change',
            'q18_trouble_adjusting_what_do',
            'q18_trouble_adjusting_what_do_status',
            'q19_slow_to_react',
            'q19_slow_to_react_change',
            'q19_slow_to_react_what_do',
            'q19_slow_to_react_what_do_status',
            'q20_dislike_tickled',
            'q20_dislike_tickled_change',
            'q20_dislike_tickled_what_do',
            'q20_dislike_tickled_what_do_status',
            'q21_ignore_tap',
            'q21_ignore_tap_change',
            'q21_ignore_tap_what_do',
            'q21_ignore_tap_what_do_status',
            'q22_refuse_new_foods',
            'q22_refuse_new_foods_change',
            'q22_refuse_new_foods_what_do',
            'q22_refuse_new_foods_what_do_status',
            'q23_smell_objects',
            'q23_smell_objects_change',
            'q23_smell_objects_what_do',
            'q23_smell_objects_what_do_status',
            'q24_interested_smell',
            'q24_interested_smell_change',
            'q24_interested_smell_what_do',
            'q24_interested_smell_what_do_status',
            'q25_put_objects',
            'q25_put_objects_change',
            'q25_put_objects_what_do',
            'q25_put_objects_what_do_status',
            'q26_enjoy_riding',
            'q26_enjoy_riding_change',
            'q26_enjoy_riding_what_do',
            'q26_enjoy_riding_what_do_status',
            'q27_like_jump',
            'q27_like_jump_change',
            'q27_like_jump_what_do',
            'q27_like_jump_what_do_status',
            'q28_seek_physical',
            'q28_seek_physical_change',
            'q28_seek_physical_what_do',
            'q28_seek_physical_what_do_status',
            'q29_uneasy_dizzy',
            'q29_uneasy_dizzy_change',
            'q29_uneasy_dizzy_what_do',
            'q29_uneasy_dizzy_what_do_status',
            'q30_flap_arms',
            'q30_flap_arms_change',
            'q30_flap_arms_what_do',
            'q30_flap_arms_what_do_status',
            'q31_free_time',
            'q31_free_time_status',
            'q32_seem_happiest',
            'q32_seem_happiest_status',
            'q33_enjoy_interaction',
            'q33_enjoy_interaction_status',
            'q34_works_best',
            'q34_works_best_status',
            'q35_other_comments',
            'q35_other_comments_status',
            'q36_a_sounds',
            'q36_b_lights',
            'q36_c_smells',
            'q36_d_tastes',
            'q36_e_textures',
            'q36_f_touch',
            'q37_seek_or_crave',
            'q37_seek_or_crave_status',
            'q38_pick_eater',
            'q38_selective',
            'q39_favourite_food_qualities',
            'q39_favourite_food_qualities_status',
            'q40_why_foods',
            'q40_why_foods_status',
            'q41_a_sounds',
            'q41_b_lights',
            'q41_c_smells',
            'q41_d_tastes',
            'q41_e_textures',
            'q41_f_touch',
            'q42_sensory_change',
            'q42_sensory_change_how',
            'q42_sensory_change_how_status',
            'q43_notice_change',
            'q43_notice_change_status'
        );
        $ndar = new NDAR_Release('seq');
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' i.Date_taken, i.' . implode($fields, ", i."));
    }

    function testMCHATProbandFields() {
        $ndar = new NDAR_Release('m_chat_proband');
        $this->assertEqual($ndar->getFields(), $this->CommonProbandFields . ' i.Date_taken, i.total_item_fails, i.total_critical_fails, i.score, i.q1_swung_on_knee, i.q2_interest_other_children, i.q3_climbing, i.q4_peek_a_boo, i.q5_pretends, i.q6_index_point, i.q7_index_interest, i.q8_play_properly, i.q9_bring_objects, i.q10_look_eye, i.q11_oversensitive, i.q12_smile_to_face, i.q13_imitate_you, i.q14_respond_to_name, i.q15_point_and_look, i.q16_walk, i.q17_look_at_similar, i.q18_unusual_finger, i.q19_try_to_attract, i.q20_wondered_deaf, i.q21_understand_speach, i.q22_stare_no_purpose, i.q23_look_at_face');
    }
    function testMullenFields() {
        $ndar = new NDAR_Release('mullen');
        $fields = array('i.other_comments',
            'i.expressive_lang_1',
            'i.expressive_lang_2',
            'i.expressive_lang_3',
            'i.expressive_lang_4',
            'i.expressive_lang_5',
            'i.expressive_lang_6',
            'i.expressive_lang_7',
            'i.expressive_lang_8',
            'i.expressive_lang_9',
            'i.expressive_lang_10',
            'i.expressive_lang_11',
            'i.expressive_lang_12',
            'i.expressive_lang_13',
            'i.expressive_lang_14',
            'i.expressive_lang_15',
            'i.expressive_lang_16',
            'i.expressive_lang_17',
            'i.expressive_lang_18',
            'i.expressive_lang_19',
            'i.expressive_lang_20',
            'i.expressive_lang_21',
            'i.expressive_lang_22',
            'i.expressive_lang_23',
            'i.expressive_lang_24',
            'i.expressive_lang_25',
            'i.expressive_lang_26',
            'i.expressive_lang_27',
            'i.expressive_lang_28',
            'i.expressive_language_raw',
            'i.expressive_language_t',
            'i.expressive_language_percentile',
            'i.expressive_language_description',
            'i.expressive_language_age_equivalent',
            'i.cognitive_t_score_sum',
            'i.composite_standard_score',
            'i.composite_percentile',
            'i.composite_description',
            'i.gross_motor_1',
            'i.gross_motor_2',
            'i.gross_motor_3',
            'i.gross_motor_4',
            'i.gross_motor_5',
            'i.gross_motor_6',
            'i.gross_motor_7',
            'i.gross_motor_8',
            'i.gross_motor_9',
            'i.gross_motor_10',
            'i.gross_motor_11',
            'i.gross_motor_12',
            'i.gross_motor_13',
            'i.gross_motor_14',
            'i.gross_motor_15',
            'i.gross_motor_16',
            'i.gross_motor_17',
            'i.gross_motor_18',
            'i.gross_motor_19',
            'i.gross_motor_20',
            'i.gross_motor_21',
            'i.gross_motor_22',
            'i.gross_motor_23',
            'i.gross_motor_24',
            'i.gross_motor_25',
            'i.gross_motor_26',
            'i.gross_motor_27',
            'i.gross_motor_28',
            'i.gross_motor_29',
            'i.gross_motor_30',
            'i.gross_motor_31',
            'i.gross_motor_32',
            'i.gross_motor_33',
            'i.gross_motor_34',
            'i.gross_motor_35',
            'i.gross_motor_raw',
            'i.gross_motor_t',
            'i.gross_motor_percentile',
            'i.gross_motor_description',
            'i.gross_motor_age_equivalent',
            'i.visual_recept_1',
            'i.visual_recept_2',
            'i.visual_recept_3',
            'i.visual_recept_4',
            'i.visual_recept_5',
            'i.visual_recept_6',
            'i.visual_recept_7',
            'i.visual_recept_8',
            'i.visual_recept_9',
            'i.visual_recept_10',
            'i.visual_recept_11',
            'i.visual_recept_12',
            'i.visual_recept_13',
            'i.visual_recept_14',
            'i.visual_recept_15',
            'i.visual_recept_16',
            'i.visual_recept_17',
            'i.visual_recept_18',
            'i.visual_recept_19',
            'i.visual_recept_20',
            'i.visual_recept_21',
            'i.visual_recept_22',
            'i.visual_recept_23',
            'i.visual_recept_24',
            'i.visual_recept_25',
            'i.visual_recept_26',
            'i.visual_recept_27',
            'i.visual_recept_28',
            'i.visual_recept_29',
            'i.visual_recept_30',
            'i.visual_recept_31',
            'i.visual_recept_32',
            'i.visual_recept_33',
            'i.visual_reception_raw',
            'i.visual_reception_t',
            'i.visual_reception_percentile',
            'i.visual_reception_description',
            'i.visual_reception_age_equivalent',
            'i.fine_motor_1',
            'i.fine_motor_2',
            'i.fine_motor_3',
            'i.fine_motor_4',
            'i.fine_motor_5',
            'i.fine_motor_6',
            'i.fine_motor_7',
            'i.fine_motor_8',
            'i.fine_motor_9',
            'i.fine_motor_10',
            'i.fine_motor_11',
            'i.fine_motor_12',
            'i.fine_motor_13',
            'i.fine_motor_14',
            'i.fine_motor_15',
            'i.fine_motor_16',
            'i.fine_motor_17',
            'i.fine_motor_18',
            'i.fine_motor_19',
            'i.fine_motor_20',
            'i.fine_motor_21',
            'i.fine_motor_22',
            'i.fine_motor_23',
            'i.fine_motor_24',
            'i.fine_motor_25',
            'i.fine_motor_26',
            'i.fine_motor_27',
            'i.fine_motor_28',
            'i.fine_motor_29',
            'i.fine_motor_30',
            'i.fine_motor_raw',
            'i.fine_motor_t',
            'i.fine_motor_percentile',
            'i.fine_motor_description',
            'i.fine_motor_age_equivalent',
            'i.receptive_lang_1',
            'i.receptive_lang_2',
            'i.receptive_lang_3',
            'i.receptive_lang_4',
            'i.receptive_lang_5',
            'i.receptive_lang_6',
            'i.receptive_lang_7',
            'i.receptive_lang_8',
            'i.receptive_lang_9',
            'i.receptive_lang_10',
            'i.receptive_lang_11',
            'i.receptive_lang_12',
            'i.receptive_lang_13',
            'i.receptive_lang_14',
            'i.receptive_lang_15',
            'i.receptive_lang_16',
            'i.receptive_lang_17',
            'i.receptive_lang_18',
            'i.receptive_lang_19',
            'i.receptive_lang_20',
            'i.receptive_lang_21',
            'i.receptive_lang_22',
            'i.receptive_lang_23',
            'i.receptive_lang_24',
            'i.receptive_lang_25',
            'i.receptive_lang_26',
            'i.receptive_lang_27',
            'i.receptive_lang_28',
            'i.receptive_lang_29',
            'i.receptive_lang_30',
            'i.receptive_lang_31',
            'i.receptive_lang_32',
            'i.receptive_lang_33',
            'i.receptive_language_raw',
            'i.receptive_language_t',
            'i.receptive_language_percentile',
            'i.receptive_language_description',
            'i.receptive_language_age_equivalent'
        );
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' f.Validity, i.Date_taken, ' . implode($fields, ', '));
    }
    function testSCQProbandFields() {
        $ndar = new NDAR_Release('scq_proband');
        $fields = array('i.score', 'i.q1_talk_short_phrases', 'i.q2_to_and_fro', 'i.q3_odd_phrases', 'i.q4_socially_inappropriate', 'i.q5_pronouns_mixed', 'i.q6_words_invented', 'i.q7_said_same_thing', 'i.q8_particular_way', 'i.q9_facial_expressions', 'i.q10_hand_like_tool', 'i.q11_interests_that_preoccupy', 'i.q12_interested_in_parts', 'i.q13_intense_interests', 'i.q14_sight_feel_sound', 'i.q15_mannerisms', 'i.q16_complicated_movements', 'i.q17_deliberate_injury', 'i.q18_carry_objects', 'i.q19_particular_friends', 'i.q20_talk_friendly', 'i.q21_spontaneously_copy', 'i.q22_spontaneously_point', 'i.q23_gestures', 'i.q24_nod_yes', 'i.q25_shake_no', 'i.q26_look_directly', 'i.q27_smile_back', 'i.q28_show_things', 'i.q29_offer_share', 'i.q30_join_enjoyment', 'i.q31_comfort', 'i.q32_wanted_something', 'i.q33_facial_expressions', 'i.q34_spontaneously_join', 'i.q35_play_pretend', 'i.q36_seem_interested', 'i.q37_respond_positively', 'i.q38_came_into_room', 'i.q39_play_imaginative', 'i.q40_play_cooperatively');
        $this->assertEqual($ndar->getFields(), $this->CommonProbandFields . ' f.Validity, i.Date_taken, ' . implode($fields, ', '));
    }
    function testSCQSubjectFields() {
        $ndar = new NDAR_Release('scq_subject');
        $fields = 'i.score, i.q1_talk_short_phrases, i.q2_to_and_fro, i.q3_odd_phrases, i.q4_socially_inappropriate, i.q5_pronouns_mixed, i.q6_words_invented, i.q7_said_same_thing, i.q8_particular_way, i.q9_facial_expressions, i.q10_hand_like_tool, i.q11_interests_that_preoccupy, i.q12_interested_in_parts, i.q13_intense_interests, i.q14_sight_feel_sound, i.q15_mannerisms, i.q16_complicated_movements, i.q17_deliberate_injury, i.q18_carry_objects, i.q19_particular_friends, i.q20_talk_friendly, i.q21_spontaneously_copy, i.q22_spontaneously_point, i.q23_gestures, i.q24_nod_yes, i.q25_shake_no, i.q26_look_directly, i.q27_smile_back, i.q28_show_things, i.q29_offer_share, i.q30_join_enjoyment, i.q31_comfort, i.q32_wanted_something, i.q33_facial_expressions, i.q34_spontaneously_join, i.q35_play_pretend, i.q36_seem_interested, i.q37_respond_positively, i.q38_came_into_room, i.q39_play_imaginative, i.q40_play_cooperatively';
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' i.Date_taken, ' . $fields);
    }

    function testVinelandFields() {
        $ndar = new NDAR_Release('vineland_subject');
        $fields = array(
            'i.RELATIONSHIP',
            'i.SEX',
            'i.DIAGNOSIS',
            'i.`ABC_%ILE_RANK` as ABC_PERCENTILE_RANK',
            'i.`ABC_95%_CI` as ABC_95PERCENT_CI',
            'i.ABC_ADAPT_LEVEL',
            'i.ABC_STANINE',
            'i.ABC_STD_SCORE',
            'i.ABC_SUM_ALL_DOM_STD_SCORES',
            'i.`CMM_95%_CI` AS CMM_95PERCENT_CI',
            'i.CMM_ADAPT_LEVEL',
            'i.CMM_AGE_EQUIV',
            'i.CMM_ITEM_1_NDAR',
            'i.CMM_ITEM_2_NDAR',
            'i.CMM_ITEM_3_NDAR',
            'i.CMM_ITEM_4_NDAR',
            'i.CMM_ITEM_5_NDAR',
            'i.CMM_ITEM_6_NDAR',
            'i.CMM_ITEM_7_NDAR',
            'i.CMM_ITEM_8_NDAR',
            'i.CMM_ITEM_9_NDAR',
            'i.CMM_ITEM_10_NDAR',
            'i.CMM_ITEM_11_NDAR',
            'i.CMM_ITEM_12_NDAR',
            'i.CMM_ITEM_13_NDAR',
            'i.CMM_ITEM_14_NDAR',
            'i.CMM_ITEM_15_NDAR',
            'i.CMM_ITEM_16_NDAR',
            'i.CMM_ITEM_17_NDAR',
            'i.CMM_ITEM_18_NDAR',
            'i.CMM_ITEM_19_NDAR',
            'i.CMM_ITEM_20_NDAR',
            'i.CMM_ITEM_21_NDAR',
            'i.CMM_ITEM_22_NDAR',
            'i.CMM_ITEM_23_NDAR',
            'i.CMM_ITEM_24_NDAR',
            'i.CMM_ITEM_25_NDAR',
            'i.CMM_ITEM_26_NDAR',
            'i.CMM_ITEM_27_NDAR',
            'i.CMM_ITEM_28_NDAR',
            'i.CMM_ITEM_29_NDAR',
            'i.CMM_ITEM_30_NDAR',
            'i.CMM_ITEM_31_NDAR',
            'i.CMM_ITEM_32_NDAR',
            'i.CMM_ITEM_33_NDAR',
            'i.CMM_ITEM_34_NDAR',
            'i.CMM_ITEM_35_NDAR',
            'i.CMM_ITEM_36_NDAR',
            'i.CMM_ITEM_37_NDAR',
            'i.CMM_ITEM_38_NDAR',
            'i.CMM_ITEM_39_NDAR',
            'i.CMM_ITEM_40_NDAR',
            'i.CMM_ITEM_41_NDAR',
            'i.CMM_ITEM_42_NDAR',
            'i.CMM_ITEM_43_NDAR',
            'i.CMM_ITEM_44_NDAR',
            'i.CMM_RAW',
            'i.CMM_SW',
            'i.CMM_VSCALE',
            'i.`COM_%ILE_RANK` as COM_PERCENTILE_RANK',
            'i.`COM_95%_CI` as COM_95PERCENT_CI',
            'i.COM_ADAPT_LEVEL',
            'i.COM_STANINE',
            'i.COM_STD_SCORE',
            'i.COM_SUM_VSCALES_FOR_DOMAIN',
            'i.COM_SW',
            'i.CRIT_ITEM_1',
            'i.CRIT_ITEM_2',
            'i.CRIT_ITEM_3',
            'i.CRIT_ITEM_4',
            'i.CRIT_ITEM_5',
            'i.CRIT_ITEM_6',
            'i.CRIT_ITEM_7',
            'i.CRIT_ITEM_8',
            'i.CRIT_ITEM_9',
            'i.CRIT_ITEM_10',
            'i.CRIT_ITEM_11',
            'i.CRIT_ITEM_12',
            'i.CRIT_ITEM_13',
            'i.CRIT_ITEM_14',
            'i.CRIT_SEVERITY_ITEM_1',
            'i.CRIT_SEVERITY_ITEM_2',
            'i.CRIT_SEVERITY_ITEM_3',
            'i.CRIT_SEVERITY_ITEM_4',
            'i.CRIT_SEVERITY_ITEM_5',
            'i.CRIT_SEVERITY_ITEM_6',
            'i.CRIT_SEVERITY_ITEM_7',
            'i.CRIT_SEVERITY_ITEM_8',
            'i.CRIT_SEVERITY_ITEM_9',
            'i.`CS_95%_CI` as CS_95PERCENT_CI',
            'i.CRIT_SEVERITY_ITEM_10',
            'i.CRIT_SEVERITY_ITEM_11',
            'i.CRIT_SEVERITY_ITEM_12',
            'i.CRIT_SEVERITY_ITEM_13',
            'i.CRIT_SEVERITY_ITEM_14',
            'i.CS_ADAPT_LEVEL',
            'i.CS_AGE_EQUIV',
            'i.CS_ITEM_1_NDAR',
            'i.CS_ITEM_2_NDAR',
            'i.CS_ITEM_3_NDAR',
            'i.CS_ITEM_4_NDAR',
            'i.CS_ITEM_5_NDAR',
            'i.CS_ITEM_6_NDAR',
            'i.CS_ITEM_7_NDAR',
            'i.CS_ITEM_8_NDAR',
            'i.CS_ITEM_9_NDAR',
            'i.CS_ITEM_10_NDAR',
            'i.CS_ITEM_11_NDAR',
            'i.CS_ITEM_12_NDAR',
            'i.CS_ITEM_13_NDAR',
            'i.CS_ITEM_14_NDAR',
            'i.CS_ITEM_15_NDAR',
            'i.CS_ITEM_16_NDAR',
            'i.CS_ITEM_17_NDAR',
            'i.CS_ITEM_18_NDAR',
            'i.CS_ITEM_19_NDAR',
            'i.CS_ITEM_20_NDAR',
            'i.CS_ITEM_21_NDAR',
            'i.CS_ITEM_22_NDAR',
            'i.CS_ITEM_23_NDAR',
            'i.CS_ITEM_24_NDAR',
            'i.CS_ITEM_25_NDAR',
            'i.CS_ITEM_26_NDAR',
            'i.CS_ITEM_27_NDAR',
            'i.CS_ITEM_28_NDAR',
            'i.CS_ITEM_29_NDAR',
            'i.CS_ITEM_30_NDAR',
            'i.CS_RAW',
            'i.CS_SW',
            'i.CS_VSCALE',
            'i.`DLS_%ILE_RANK` as DLS_PERCENTILE_RANK',
            'i.`DLS_95%_CI` as DLS_95PERCENT_CI',
            'i.DLS_ADAPT_LEVEL',
            'i.DLS_STANINE',
            'i.DLS_STD_SCORE',
            'i.DLS_SUM_VSCALES_FOR_DOMAIN',
            'i.DLS_SW',
            'i.`DOM_95%_CI` as DOM_95PERCENT_CI',
            'i.DOM_ADAPT_LEVEL',
            'i.DOM_AGE_EQUIV',
            'i.DOM_ITEM_1_NDAR',
            'i.DOM_ITEM_2_NDAR',
            'i.DOM_ITEM_3_NDAR',
            'i.DOM_ITEM_4_NDAR',
            'i.DOM_ITEM_5_NDAR',
            'i.DOM_ITEM_6_NDAR',
            'i.DOM_ITEM_7_NDAR',
            'i.DOM_ITEM_8_NDAR',
            'i.DOM_ITEM_9_NDAR',
            'i.DOM_ITEM_10_NDAR',
            'i.DOM_ITEM_11_NDAR',
            'i.DOM_ITEM_12_NDAR',
            'i.DOM_ITEM_13_NDAR',
            'i.DOM_ITEM_14_NDAR',
            'i.DOM_ITEM_15_NDAR',
            'i.DOM_ITEM_16_NDAR',
            'i.DOM_ITEM_17_NDAR',
            'i.DOM_ITEM_18_NDAR',
            'i.DOM_ITEM_19_NDAR',
            'i.DOM_ITEM_20_NDAR',
            'i.DOM_ITEM_21_NDAR',
            'i.DOM_ITEM_22_NDAR',
            'i.DOM_ITEM_23_NDAR',
            'i.DOM_ITEM_24_NDAR',
            'i.DOM_RAW',
            'i.DOM_SW',
            'i.DOM_VSCALE',
            'i.`EXP_95%_CI` AS EXP_95PERCENT_CI',
            'i.EXP_ADAPT_LEVEL',
            'i.EXP_AGE_EQUIV',
            'i.EXP_ITEM_1_NDAR',
            'i.EXP_ITEM_2_NDAR',
            'i.EXP_ITEM_3_NDAR',
            'i.EXP_ITEM_4_NDAR',
            'i.EXP_ITEM_5_NDAR',
            'i.EXP_ITEM_6_NDAR',
            'i.EXP_ITEM_7_NDAR',
            'i.EXP_ITEM_8_NDAR',
            'i.EXP_ITEM_9_NDAR',
            'i.EXP_ITEM_10_NDAR',
            'i.EXP_ITEM_11_NDAR',
            'i.EXP_ITEM_12_NDAR',
            'i.EXP_ITEM_13_NDAR',
            'i.EXP_ITEM_14_NDAR',
            'i.EXP_ITEM_15_NDAR',
            'i.EXP_ITEM_16_NDAR',
            'i.EXP_ITEM_17_NDAR',
            'i.EXP_ITEM_18_NDAR',
            'i.EXP_ITEM_19_NDAR',
            'i.EXP_ITEM_20_NDAR',
            'i.EXP_ITEM_21_NDAR',
            'i.EXP_ITEM_22_NDAR',
            'i.EXP_ITEM_23_NDAR',
            'i.EXP_ITEM_24_NDAR',
            'i.EXP_ITEM_25_NDAR',
            'i.EXP_ITEM_26_NDAR',
            'i.EXP_ITEM_27_NDAR',
            'i.EXP_ITEM_28_NDAR',
            'i.EXP_ITEM_29_NDAR',
            'i.EXP_ITEM_30_NDAR',
            'i.EXP_ITEM_31_NDAR',
            'i.EXP_ITEM_32_NDAR',
            'i.EXP_ITEM_33_NDAR',
            'i.EXP_ITEM_34_NDAR',
            'i.EXP_ITEM_35_NDAR',
            'i.EXP_ITEM_36_NDAR',
            'i.EXP_ITEM_37_NDAR',
            'i.EXP_ITEM_38_NDAR',
            'i.EXP_ITEM_39_NDAR',
            'i.EXP_ITEM_40_NDAR',
            'i.EXP_ITEM_41_NDAR',
            'i.EXP_ITEM_42_NDAR',
            'i.EXP_ITEM_43_NDAR',
            'i.EXP_ITEM_44_NDAR',
            'i.EXP_ITEM_45_NDAR',
            'i.EXP_ITEM_46_NDAR',
            'i.EXP_ITEM_47_NDAR',
            'i.EXP_ITEM_48_NDAR',
            'i.EXP_ITEM_49_NDAR',
            'i.EXP_ITEM_50_NDAR',
            'i.EXP_ITEM_51_NDAR',
            'i.EXP_ITEM_52_NDAR',
            'i.EXP_ITEM_53_NDAR',
            'i.EXP_ITEM_54_NDAR',
            'i.EXP_RAW',
            'i.EXP_SW',
            'i.EXP_VSCALE',
            'i.`EXT_95%_CI` AS EXT_95PERCENT_CI',
            'i.EXT_ADAPT_LEVEL',
            'i.EXT_ITEM_1_NDAR',
            'i.EXT_ITEM_2_NDAR',
            'i.EXT_ITEM_3_NDAR',
            'i.EXT_ITEM_4_NDAR',
            'i.EXT_ITEM_5_NDAR',
            'i.EXT_ITEM_6_NDAR',
            'i.EXT_ITEM_7_NDAR',
            'i.EXT_ITEM_8_NDAR',
            'i.EXT_ITEM_9_NDAR',
            'i.EXT_ITEM_10_NDAR',
            'i.EXT_RAW',
            'i.EXT_VSCALE',
            'i.`FMS_95%_CI` AS FMS_95PERCENT_CI',
            'i.FMS_ADAPT_LEVEL',
            'i.FMS_AGE_EQUIV',
            'i.FMS_ITEM_1_NDAR',
            'i.FMS_ITEM_2_NDAR',
            'i.FMS_ITEM_3_NDAR',
            'i.FMS_ITEM_4_NDAR',
            'i.FMS_ITEM_5_NDAR',
            'i.FMS_ITEM_6_NDAR',
            'i.FMS_ITEM_7_NDAR',
            'i.FMS_ITEM_8_NDAR',
            'i.FMS_ITEM_9_NDAR',
            'i.FMS_ITEM_10_NDAR',
            'i.FMS_ITEM_11_NDAR',
            'i.FMS_ITEM_12_NDAR',
            'i.FMS_ITEM_13_NDAR',
            'i.FMS_ITEM_14_NDAR',
            'i.FMS_ITEM_15_NDAR',
            'i.FMS_ITEM_16_NDAR',
            'i.FMS_ITEM_17_NDAR',
            'i.FMS_ITEM_18_NDAR',
            'i.FMS_ITEM_19_NDAR',
            'i.FMS_ITEM_20_NDAR',
            'i.FMS_ITEM_21_NDAR',
            'i.FMS_ITEM_22_NDAR',
            'i.FMS_ITEM_23_NDAR',
            'i.FMS_ITEM_24_NDAR',
            'i.FMS_ITEM_25_NDAR',
            'i.FMS_ITEM_26_NDAR',
            'i.FMS_ITEM_27_NDAR',
            'i.FMS_ITEM_28_NDAR',
            'i.FMS_ITEM_29_NDAR',
            'i.FMS_ITEM_30_NDAR',
            'i.FMS_ITEM_31_NDAR',
            'i.FMS_ITEM_32_NDAR',
            'i.FMS_ITEM_33_NDAR',
            'i.FMS_ITEM_34_NDAR',
            'i.FMS_ITEM_35_NDAR',
            'i.FMS_ITEM_36_NDAR',
            'i.FMS_RAW',
            'i.FMS_SW',
            'i.FMS_VSCALE',
            'i.`GMS_95%_CI` as GMS_95PERCENT_CI',
            'i.GMS_ADAPT_LEVEL',
            'i.GMS_AGE_EQUIV',
            'i.GMS_ITEM_1_NDAR',
            'i.GMS_ITEM_2_NDAR',
            'i.GMS_ITEM_3_NDAR',
            'i.GMS_ITEM_4_NDAR',
            'i.GMS_ITEM_5_NDAR',
            'i.GMS_ITEM_6_NDAR',
            'i.GMS_ITEM_7_NDAR',
            'i.GMS_ITEM_8_NDAR',
            'i.GMS_ITEM_9_NDAR',
            'i.GMS_ITEM_10_NDAR',
            'i.GMS_ITEM_11_NDAR',
            'i.GMS_ITEM_12_NDAR',
            'i.GMS_ITEM_13_NDAR',
            'i.GMS_ITEM_14_NDAR',
            'i.GMS_ITEM_15_NDAR',
            'i.GMS_ITEM_16_NDAR',
            'i.GMS_ITEM_17_NDAR',
            'i.GMS_ITEM_18_NDAR',
            'i.GMS_ITEM_19_NDAR',
            'i.GMS_ITEM_20_NDAR',
            'i.GMS_ITEM_21_NDAR',
            'i.GMS_ITEM_22_NDAR',
            'i.GMS_ITEM_23_NDAR',
            'i.GMS_ITEM_24_NDAR',
            'i.GMS_ITEM_25_NDAR',
            'i.GMS_ITEM_26_NDAR',
            'i.GMS_ITEM_27_NDAR',
            'i.GMS_ITEM_28_NDAR',
            'i.GMS_ITEM_29_NDAR',
            'i.GMS_ITEM_30_NDAR',
            'i.GMS_ITEM_31_NDAR',
            'i.GMS_ITEM_32_NDAR',
            'i.GMS_ITEM_33_NDAR',
            'i.GMS_ITEM_34_NDAR',
            'i.GMS_ITEM_35_NDAR',
            'i.GMS_ITEM_36_NDAR',
            'i.GMS_ITEM_37_NDAR',
            'i.GMS_ITEM_38_NDAR',
            'i.GMS_ITEM_39_NDAR',
            'i.GMS_ITEM_40_NDAR',
            'i.GMS_RAW',
            'i.GMS_SW',
            'i.GMS_VSCALE',
            'i.GRADE',
            'i.`INT_95%_CI` AS INT_95PERCENT_CI',
            'i.INT_ADAPT_LEVEL',
            'i.INT_ITEM_1_NDAR',
            'i.INT_ITEM_2_NDAR',
            'i.INT_ITEM_3_NDAR',
            'i.INT_ITEM_4_NDAR',
            'i.INT_ITEM_5_NDAR',
            'i.INT_ITEM_6_NDAR',
            'i.INT_ITEM_7_NDAR',
            'i.INT_ITEM_8_NDAR',
            'i.INT_ITEM_9_NDAR',
            'i.INT_ITEM_10_NDAR',
            'i.INT_ITEM_11_NDAR',
            'i.INT_RAW',
            'i.INT_VSCALE',
            'i.`IPR_95%_CI` AS IPR_95PERCENT_CI',
            'i.IPR_ADAPT_LEVEL',
            'i.IPR_AGE_EQUIV',
            'i.IPR_ITEM_1_NDAR',
            'i.IPR_ITEM_2_NDAR',
            'i.IPR_ITEM_3_NDAR',
            'i.IPR_ITEM_4_NDAR',
            'i.IPR_ITEM_5_NDAR',
            'i.IPR_ITEM_6_NDAR',
            'i.IPR_ITEM_7_NDAR',
            'i.IPR_ITEM_8_NDAR',
            'i.IPR_ITEM_9_NDAR',
            'i.IPR_ITEM_10_NDAR',
            'i.IPR_ITEM_11_NDAR',
            'i.IPR_ITEM_12_NDAR',
            'i.IPR_ITEM_13_NDAR',
            'i.IPR_ITEM_14_NDAR',
            'i.IPR_ITEM_15_NDAR',
            'i.IPR_ITEM_16_NDAR',
            'i.IPR_ITEM_17_NDAR',
            'i.IPR_ITEM_18_NDAR',
            'i.IPR_ITEM_19_NDAR',
            'i.IPR_ITEM_20_NDAR',
            'i.IPR_ITEM_21_NDAR',
            'i.IPR_ITEM_22_NDAR',
            'i.IPR_ITEM_23_NDAR',
            'i.IPR_ITEM_24_NDAR',
            'i.IPR_ITEM_25_NDAR',
            'i.IPR_ITEM_26_NDAR',
            'i.IPR_ITEM_27_NDAR',
            'i.IPR_ITEM_28_NDAR',
            'i.IPR_ITEM_29_NDAR',
            'i.IPR_ITEM_30_NDAR',
            'i.IPR_ITEM_31_NDAR',
            'i.IPR_ITEM_32_NDAR',
            'i.IPR_ITEM_33_NDAR',
            'i.IPR_ITEM_34_NDAR',
            'i.IPR_ITEM_35_NDAR',
            'i.IPR_ITEM_36_NDAR',
            'i.IPR_ITEM_37_NDAR',
            'i.IPR_ITEM_38_NDAR',
            'i.IPR_RAW',
            'i.IPR_SW',
            'i.IPR_VSCALE',
            'i.`MBI_95%_CI` AS MBI_95PERCENT_CI',
            'i.MBI_ADAPT_LEVEL',
            'i.MBI_RAW',
            'i.MBI_VSCALE',
            'i.`MS_%ILE_RANK` AS MS_PERCENTILE_RANK',
            'i.`MS_95%_CI` AS MS_95PERCENT_CI',
            'i.MS_ADAPT_LEVEL',
            'i.MS_STANINE',
            'i.MS_STD_SCORE',
            'i.MS_SUM_VSCALES_FOR_DOMAIN',
            'i.MS_SW',
            'i.OTH_ITEM_1_NDAR',
            'i.OTH_ITEM_2_NDAR',
            'i.OTH_ITEM_3_NDAR',
            'i.OTH_ITEM_4_NDAR',
            'i.OTH_ITEM_5_NDAR',
            'i.OTH_ITEM_6_NDAR',
            'i.OTH_ITEM_7_NDAR',
            'i.OTH_ITEM_8_NDAR',
            'i.OTH_ITEM_9_NDAR',
            'i.OTH_ITEM_10_NDAR',
            'i.OTH_ITEM_11_NDAR',
            'i.OTH_ITEM_12_NDAR',
            'i.OTH_ITEM_13_NDAR',
            'i.OTH_ITEM_14_NDAR',
            'i.OTH_ITEM_15_NDAR',
            'i.`PER_95%_CI` AS PER_95PERCENT_CI',
            'i.PER_ADAPT_LEVEL',
            'i.PER_AGE_EQUIV',
            'i.PER_ITEM_1_NDAR',
            'i.PER_ITEM_2_NDAR',
            'i.PER_ITEM_3_NDAR',
            'i.PER_ITEM_4_NDAR',
            'i.PER_ITEM_5_NDAR',
            'i.PER_ITEM_6_NDAR',
            'i.PER_ITEM_7_NDAR',
            'i.PER_ITEM_8_NDAR',
            'i.PER_ITEM_9_NDAR',
            'i.PER_ITEM_10_NDAR',
            'i.PER_ITEM_11_NDAR',
            'i.PER_ITEM_12_NDAR',
            'i.PER_ITEM_13_NDAR',
            'i.PER_ITEM_14_NDAR',
            'i.PER_ITEM_15_NDAR',
            'i.PER_ITEM_16_NDAR',
            'i.PER_ITEM_17_NDAR',
            'i.PER_ITEM_18_NDAR',
            'i.PER_ITEM_19_NDAR',
            'i.PER_ITEM_20_NDAR',
            'i.PER_ITEM_21_NDAR',
            'i.PER_ITEM_22_NDAR',
            'i.PER_ITEM_23_NDAR',
            'i.PER_ITEM_24_NDAR',
            'i.PER_ITEM_25_NDAR',
            'i.PER_ITEM_26_NDAR',
            'i.PER_ITEM_27_NDAR',
            'i.PER_ITEM_28_NDAR',
            'i.PER_ITEM_29_NDAR',
            'i.PER_ITEM_30_NDAR',
            'i.PER_ITEM_31_NDAR',
            'i.PER_ITEM_32_NDAR',
            'i.PER_ITEM_33_NDAR',
            'i.PER_ITEM_34_NDAR',
            'i.PER_ITEM_35_NDAR',
            'i.PER_ITEM_36_NDAR',
            'i.PER_ITEM_37_NDAR',
            'i.PER_ITEM_38_NDAR',
            'i.PER_ITEM_39_NDAR',
            'i.PER_ITEM_40_NDAR',
            'i.PER_ITEM_41_NDAR',
            'i.PER_RAW',
            'i.PER_SW',
            'i.PER_VSCALE',
            'i.`PL_95%_CI` AS PL_95PERCENT_CI',
            'i.PL_ADAPT_LEVEL',
            'i.PL_AGE_EQUIV',
            'i.PL_ITEM_1_NDAR',
            'i.PL_ITEM_2_NDAR',
            'i.PL_ITEM_3_NDAR',
            'i.PL_ITEM_4_NDAR',
            'i.PL_ITEM_5_NDAR',
            'i.PL_ITEM_6_NDAR',
            'i.PL_ITEM_7_NDAR',
            'i.PL_ITEM_8_NDAR',
            'i.PL_ITEM_9_NDAR',
            'i.PL_ITEM_10_NDAR',
            'i.PL_ITEM_11_NDAR',
            'i.PL_ITEM_12_NDAR',
            'i.PL_ITEM_13_NDAR',
            'i.PL_ITEM_14_NDAR',
            'i.PL_ITEM_15_NDAR',
            'i.PL_ITEM_16_NDAR',
            'i.PL_ITEM_17_NDAR',
            'i.PL_ITEM_18_NDAR',
            'i.PL_ITEM_19_NDAR',
            'i.PL_ITEM_20_NDAR',
            'i.PL_ITEM_21_NDAR',
            'i.PL_ITEM_22_NDAR',
            'i.PL_ITEM_23_NDAR',
            'i.PL_ITEM_24_NDAR',
            'i.PL_ITEM_25_NDAR',
            'i.PL_ITEM_26_NDAR',
            'i.PL_ITEM_27_NDAR',
            'i.PL_ITEM_28_NDAR',
            'i.PL_ITEM_29_NDAR',
            'i.PL_ITEM_30_NDAR',
            'i.PL_ITEM_31_NDAR',
            'i.PL_RAW',
            'i.PL_SW',
            'i.PL_VSCALE',
            'i.`REC_95%_CI` AS REC_95PERCENT_CI',
            'i.REC_ADAPT_LEVEL',
            'i.REC_AGE_EQUIV',
            'i.REC_ITEM_1_NDAR',
            'i.REC_ITEM_2_NDAR',
            'i.REC_ITEM_3_NDAR',
            'i.REC_ITEM_4_NDAR',
            'i.REC_ITEM_5_NDAR',
            'i.REC_ITEM_6_NDAR',
            'i.REC_ITEM_7_NDAR',
            'i.REC_ITEM_8_NDAR',
            'i.REC_ITEM_9_NDAR',
            'i.REC_ITEM_10_NDAR',
            'i.REC_ITEM_11_NDAR',
            'i.REC_ITEM_12_NDAR',
            'i.REC_ITEM_13_NDAR',
            'i.REC_ITEM_14_NDAR',
            'i.REC_ITEM_15_NDAR',
            'i.REC_ITEM_16_NDAR',
            'i.REC_ITEM_17_NDAR',
            'i.REC_ITEM_18_NDAR',
            'i.REC_ITEM_19_NDAR',
            'i.REC_ITEM_20_NDAR',
            'i.REC_RAW',
            'i.REC_SW',
            'i.REC_VSCALE',
            'i.`SOC_%ILE_RANK` AS SOC_PERCENTILE_RANK',
            'i.`SOC_95%_CI` as SOC_95PERCENT_CI',
            'i.SOC_ADAPT_LEVEL',
            'i.SOC_STANINE',
            'i.SOC_STD_SCORE',
            'i.SOC_SUM_VSCALES_FOR_DOMAIN',
            'i.SOC_SW',
            'i.`WRN_95%_CI` AS WRN_95PERCENT_CI',
            'i.WRN_ADAPT_LEVEL',
            'i.WRN_AGE_EQUIV',
            'i.WRN_ITEM_1_NDAR',
            'i.WRN_ITEM_2_NDAR',
            'i.WRN_ITEM_3_NDAR',
            'i.WRN_ITEM_4_NDAR',
            'i.WRN_ITEM_5_NDAR',
            'i.WRN_ITEM_6_NDAR',
            'i.WRN_ITEM_7_NDAR',
            'i.WRN_ITEM_8_NDAR',
            'i.WRN_ITEM_9_NDAR',
            'i.WRN_ITEM_10_NDAR',
            'i.WRN_ITEM_11_NDAR',
            'i.WRN_ITEM_12_NDAR',
            'i.WRN_ITEM_13_NDAR',
            'i.WRN_ITEM_14_NDAR',
            'i.WRN_ITEM_15_NDAR',
            'i.WRN_ITEM_16_NDAR',
            'i.WRN_ITEM_17_NDAR',
            'i.WRN_ITEM_18_NDAR',
            'i.WRN_ITEM_19_NDAR',
            'i.WRN_ITEM_20_NDAR',
            'i.WRN_ITEM_21_NDAR',
            'i.WRN_ITEM_22_NDAR',
            'i.WRN_ITEM_23_NDAR',
            'i.WRN_ITEM_24_NDAR',
            'i.WRN_ITEM_25_NDAR',
            'i.WRN_RAW',
            'i.WRN_SW',
            'i.WRN_VSCALE');
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' f.Validity, i.Date_taken, ' . implode($fields, ', '));
        $ndar = new NDAR_Release('vineland_proband');
        $this->assertEqual($ndar->getFields(), $this->CommonProbandFields . ' f.Validity, i.Date_taken, ' . implode($fields, ', '));
    }

    function testRBSRFields() {
        $ndar = new NDAR_Release('rbs_r');
        $fields = array('i.Date_taken', 'i.Candidate_Age', 'i.respondent', 'i.respondent_specify', 'i.I_stereotyped_endorsed', 'i.I_stereotyped_score', 'i.II_self_injurious_endorsed', 'i.II_self_injurious_score', 'i.III_compulsive_endorsed', 'i.III_compulsive_score', 'i.IV_ritualistic_endorsed', 'i.IV_ritualistic_score', 'i.overall_endorsed', 'i.overall_score', 'i.q1_whole_body', 'i.q10_bites_self', 'i.q11_pulls', 'i.q12_rubs_or_scratches', 'i.q13_inserts_finger_or_object', 'i.q14_skin_picking', 'i.q15_arranging_ordering', 'i.q16_completeness', 'i.q17_washing_cleaning', 'i.q18_checking', 'i.q19_counting', 'i.q2_head', 'i.q20_hoarding_saving', 'i.q21_repeating', 'i.q22_touch_tap', 'i.q23_eating_mealtime', 'i.q24_sleeping_bedtime', 'i.q25_self_care', 'i.q26_travel_transportation', 'i.q27_play_leisure', 'i.q28_communication', 'i.q29_insists_things_remain', 'i.q3_hand_finger', 'i.q30_objects_to_visiting', 'i.q31_upset_if_interrupted', 'i.q32_walking_in_a_pattern', 'i.q33_insists_on_sitting_at_same_place', 'i.q34_dislikes_change', 'i.q35_insists_on_particular_door', 'i.q36_likes_same_cd', 'i.q37_resists_changing_activities', 'i.q38_insists_on_same_routine', 'i.q39_insists_that_specific', 'i.q4_locomotion', 'i.q40_fascination_preoccupation', 'i.q41_strongly_attached', 'i.q42_preoccupation_with_parts', 'i.q43_fascination_with_movement', 'i.q5_object_usage', 'i.q6_sensory', 'i.q7_hits_self_body_part', 'i.q8_hits_self_against_surface', 'i.q9_hits_self_with_object', 'i.V_sameness_endorsed', 'i.V_sameness_score', 'i.VI_restricted_endorsed', 'i.VI_restricted_score');
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' i.Date_taken, ' . implode($fields, ', '));
    }

    function testMacarthurFields() {
        $ndar = new NDAR_Release('macarthur_words_gestures');
        $fields = array('Candidate_Age',
            'early_gestures_number',
            'early_gestures_percentile',
            'I_A_1',
            'I_A_2',
            'I_A_3',
            'I_B_1',
            'I_B_10',
            'I_B_11',
            'I_B_12',
            'I_B_13',
            'I_B_14',
            'I_B_15',
            'I_B_16',
            'I_B_17',
            'I_B_18',
            'I_B_19',
            'I_B_2',
            'I_B_20',
            'I_B_21',
            'I_B_22',
            'I_B_23',
            'I_B_24',
            'I_B_25',
            'I_B_26',
            'I_B_27',
            'I_B_28',
            'I_B_3',
            'I_B_4',
            'I_B_5',
            'I_B_6',
            'I_B_7',
            'I_B_8',
            'I_B_9',
            'I_C_1',
            'I_C_1_score',
            'I_C_2',
            'I_C_2_score',
            'I_D_1_1',
            'I_D_1_10',
            'I_D_1_11',
            'I_D_1_12',
            'I_D_1_2',
            'I_D_1_3',
            'I_D_1_4',
            'I_D_1_5',
            'I_D_1_6',
            'I_D_1_7',
            'I_D_1_8',
            'I_D_1_9',
            'I_D_10_1',
            'I_D_10_10',
            'I_D_10_11',
            'I_D_10_12',
            'I_D_10_13',
            'I_D_10_14',
            'I_D_10_15',
            'I_D_10_16',
            'I_D_10_17',
            'I_D_10_18',
            'I_D_10_19',
            'I_D_10_2',
            'I_D_10_20',
            'I_D_10_21',
            'I_D_10_22',
            'I_D_10_23',
            'I_D_10_24',
            'I_D_10_25',
            'I_D_10_26',
            'I_D_10_27',
            'I_D_10_3',
            'I_D_10_4',
            'I_D_10_5',
            'I_D_10_6',
            'I_D_10_7',
            'I_D_10_8',
            'I_D_10_9',
            'I_D_11_1',
            'I_D_11_10',
            'I_D_11_11',
            'I_D_11_12',
            'I_D_11_13',
            'I_D_11_14',
            'I_D_11_15',
            'I_D_11_16',
            'I_D_11_17',
            'I_D_11_18',
            'I_D_11_19',
            'I_D_11_2',
            'I_D_11_20',
            'I_D_11_3',
            'I_D_11_4',
            'I_D_11_5',
            'I_D_11_6',
            'I_D_11_7',
            'I_D_11_8',
            'I_D_11_9',
            'I_D_12_1',
            'I_D_12_10',
            'I_D_12_11',
            'I_D_12_12',
            'I_D_12_13',
            'I_D_12_14',
            'I_D_12_15',
            'I_D_12_16',
            'I_D_12_17',
            'I_D_12_18',
            'I_D_12_19',
            'I_D_12_2',
            'I_D_12_3',
            'I_D_12_4',
            'I_D_12_5',
            'I_D_12_6',
            'I_D_12_7',
            'I_D_12_8',
            'I_D_12_9',
            'I_D_13_1',
            'I_D_13_10',
            'I_D_13_11',
            'I_D_13_12',
            'I_D_13_13',
            'I_D_13_14',
            'I_D_13_15',
            'I_D_13_16',
            'I_D_13_17',
            'I_D_13_18',
            'I_D_13_19',
            'I_D_13_2',
            'I_D_13_20',
            'I_D_13_21',
            'I_D_13_22',
            'I_D_13_23',
            'I_D_13_24',
            'I_D_13_25',
            'I_D_13_26',
            'I_D_13_27',
            'I_D_13_28',
            'I_D_13_29',
            'I_D_13_3',
            'I_D_13_30',
            'I_D_13_31',
            'I_D_13_32',
            'I_D_13_33',
            'I_D_13_34',
            'I_D_13_35',
            'I_D_13_36',
            'I_D_13_37',
            'I_D_13_38',
            'I_D_13_39',
            'I_D_13_4',
            'I_D_13_40',
            'I_D_13_41',
            'I_D_13_42',
            'I_D_13_43',
            'I_D_13_44',
            'I_D_13_45',
            'I_D_13_46',
            'I_D_13_47',
            'I_D_13_48',
            'I_D_13_49',
            'I_D_13_5',
            'I_D_13_50',
            'I_D_13_51',
            'I_D_13_52',
            'I_D_13_53',
            'I_D_13_54',
            'I_D_13_55',
            'I_D_13_6',
            'I_D_13_7',
            'I_D_13_8',
            'I_D_13_9',
            'I_D_14_1',
            'I_D_14_2',
            'I_D_14_3',
            'I_D_14_4',
            'I_D_14_5',
            'I_D_14_6',
            'I_D_14_7',
            'I_D_14_8',
            'I_D_15_1',
            'I_D_15_10',
            'I_D_15_11',
            'I_D_15_12',
            'I_D_15_13',
            'I_D_15_14',
            'I_D_15_15',
            'I_D_15_16',
            'I_D_15_17',
            'I_D_15_18',
            'I_D_15_19',
            'I_D_15_2',
            'I_D_15_20',
            'I_D_15_21',
            'I_D_15_22',
            'I_D_15_23',
            'I_D_15_24',
            'I_D_15_25',
            'I_D_15_26',
            'I_D_15_27',
            'I_D_15_28',
            'I_D_15_29',
            'I_D_15_3',
            'I_D_15_30',
            'I_D_15_31',
            'I_D_15_32',
            'I_D_15_33',
            'I_D_15_34',
            'I_D_15_35',
            'I_D_15_36',
            'I_D_15_37',
            'I_D_15_4',
            'I_D_15_5',
            'I_D_15_6',
            'I_D_15_7',
            'I_D_15_8',
            'I_D_15_9',
            'I_D_16_1',
            'I_D_16_10',
            'I_D_16_11',
            'I_D_16_2',
            'I_D_16_3',
            'I_D_16_4',
            'I_D_16_5',
            'I_D_16_6',
            'I_D_16_7',
            'I_D_16_8',
            'I_D_16_9',
            'I_D_17_1',
            'I_D_17_2',
            'I_D_17_3',
            'I_D_17_4',
            'I_D_17_5',
            'I_D_17_6',
            'I_D_18_1',
            'I_D_18_10',
            'I_D_18_11',
            'I_D_18_2',
            'I_D_18_3',
            'I_D_18_4',
            'I_D_18_5',
            'I_D_18_6',
            'I_D_18_7',
            'I_D_18_8',
            'I_D_18_9',
            'I_D_19_1',
            'I_D_19_2',
            'I_D_19_3',
            'I_D_19_4',
            'I_D_19_5',
            'I_D_19_6',
            'I_D_19_7',
            'I_D_19_8',
            'I_D_2_1',
            'I_D_2_10',
            'I_D_2_11',
            'I_D_2_12',
            'I_D_2_13',
            'I_D_2_14',
            'I_D_2_15',
            'I_D_2_16',
            'I_D_2_17',
            'I_D_2_18',
            'I_D_2_19',
            'I_D_2_2',
            'I_D_2_20',
            'I_D_2_21',
            'I_D_2_22',
            'I_D_2_23',
            'I_D_2_24',
            'I_D_2_25',
            'I_D_2_26',
            'I_D_2_27',
            'I_D_2_28',
            'I_D_2_29',
            'I_D_2_3',
            'I_D_2_30',
            'I_D_2_31',
            'I_D_2_32',
            'I_D_2_33',
            'I_D_2_34',
            'I_D_2_35',
            'I_D_2_36',
            'I_D_2_4',
            'I_D_2_5',
            'I_D_2_6',
            'I_D_2_7',
            'I_D_2_8',
            'I_D_2_9',
            'I_D_3_1',
            'I_D_3_2',
            'I_D_3_3',
            'I_D_3_4',
            'I_D_3_5',
            'I_D_3_6',
            'I_D_3_7',
            'I_D_3_8',
            'I_D_3_9',
            'I_D_4_1',
            'I_D_4_2',
            'I_D_4_3',
            'I_D_4_4',
            'I_D_4_5',
            'I_D_4_6',
            'I_D_4_7',
            'I_D_4_8',
            'I_D_5_1',
            'I_D_5_10',
            'I_D_5_11',
            'I_D_5_12',
            'I_D_5_13',
            'I_D_5_14',
            'I_D_5_15',
            'I_D_5_16',
            'I_D_5_17',
            'I_D_5_18',
            'I_D_5_19',
            'I_D_5_2',
            'I_D_5_20',
            'I_D_5_21',
            'I_D_5_22',
            'I_D_5_23',
            'I_D_5_24',
            'I_D_5_25',
            'I_D_5_26',
            'I_D_5_27',
            'I_D_5_28',
            'I_D_5_29',
            'I_D_5_3',
            'I_D_5_30',
            'I_D_5_4',
            'I_D_5_5',
            'I_D_5_6',
            'I_D_5_7',
            'I_D_5_8',
            'I_D_5_9',
            'I_D_6_1',
            'I_D_6_10',
            'I_D_6_11',
            'I_D_6_12',
            'I_D_6_13',
            'I_D_6_14',
            'I_D_6_15',
            'I_D_6_16',
            'I_D_6_17',
            'I_D_6_18',
            'I_D_6_19',
            'I_D_6_2',
            'I_D_6_3',
            'I_D_6_4',
            'I_D_6_5',
            'I_D_6_6',
            'I_D_6_7',
            'I_D_6_8',
            'I_D_6_9',
            'I_D_7_1',
            'I_D_7_10',
            'I_D_7_11',
            'I_D_7_12',
            'I_D_7_13',
            'I_D_7_14',
            'I_D_7_15',
            'I_D_7_16',
            'I_D_7_17',
            'I_D_7_18',
            'I_D_7_19',
            'I_D_7_2',
            'I_D_7_20',
            'I_D_7_3',
            'I_D_7_4',
            'I_D_7_5',
            'I_D_7_6',
            'I_D_7_7',
            'I_D_7_8',
            'I_D_7_9',
            'I_D_8_1',
            'I_D_8_10',
            'I_D_8_11',
            'I_D_8_12',
            'I_D_8_13',
            'I_D_8_14',
            'I_D_8_15',
            'I_D_8_16',
            'I_D_8_17',
            'I_D_8_18',
            'I_D_8_19',
            'I_D_8_2',
            'I_D_8_20',
            'I_D_8_21',
            'I_D_8_22',
            'I_D_8_23',
            'I_D_8_24',
            'I_D_8_3',
            'I_D_8_4',
            'I_D_8_5',
            'I_D_8_6',
            'I_D_8_7',
            'I_D_8_8',
            'I_D_8_9',
            'I_D_9_1',
            'I_D_9_10',
            'I_D_9_11',
            'I_D_9_12',
            'I_D_9_13',
            'I_D_9_14',
            'I_D_9_15',
            'I_D_9_16',
            'I_D_9_17',
            'I_D_9_18',
            'I_D_9_19',
            'I_D_9_2',
            'I_D_9_20',
            'I_D_9_21',
            'I_D_9_22',
            'I_D_9_23',
            'I_D_9_24',
            'I_D_9_25',
            'I_D_9_26',
            'I_D_9_27',
            'I_D_9_28',
            'I_D_9_29',
            'I_D_9_3',
            'I_D_9_30',
            'I_D_9_31',
            'I_D_9_32',
            'I_D_9_33',
            'I_D_9_34',
            'I_D_9_35',
            'I_D_9_36',
            'I_D_9_4',
            'I_D_9_5',
            'I_D_9_6',
            'I_D_9_7',
            'I_D_9_8',
            'I_D_9_9',
            'II_A_1',
            'II_A_10',
            'II_A_11',
            'II_A_12',
            'II_A_2',
            'II_A_3',
            'II_A_4',
            'II_A_5',
            'II_A_6',
            'II_A_7',
            'II_A_8',
            'II_A_9',
            'II_B_1',
            'II_B_2',
            'II_B_3',
            'II_B_4',
            'II_B_5',
            'II_B_6',
            'II_C_1',
            'II_C_10',
            'II_C_11',
            'II_C_12',
            'II_C_13',
            'II_C_14',
            'II_C_15',
            'II_C_16',
            'II_C_17',
            'II_C_2',
            'II_C_3',
            'II_C_4',
            'II_C_5',
            'II_C_6',
            'II_C_7',
            'II_C_8',
            'II_C_9',
            'II_D_1',
            'II_D_10',
            'II_D_11',
            'II_D_12',
            'II_D_13',
            'II_D_2',
            'II_D_3',
            'II_D_4',
            'II_D_5',
            'II_D_6',
            'II_D_7',
            'II_D_8',
            'II_D_9',
            'II_E_1',
            'II_E_10',
            'II_E_11',
            'II_E_12',
            'II_E_13',
            'II_E_14',
            'II_E_15',
            'II_E_2',
            'II_E_3',
            'II_E_4',
            'II_E_5',
            'II_E_6',
            'II_E_7',
            'II_E_8',
            'II_E_9',
            'II_F_replacement',
            'II_F_replacement_comments',
            'II_F_replacement_comments_status',
            'II_F_replacement_examples',
            'II_F_replacement_examples_status',
            'later_gestures_number',
            'later_gestures_percentile',
            'phrases_understood_number',
            'phrases_understood_percentile');
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' i.Date_taken, i.' . implode($fields, ', i.'));

    }
    function testCSBSFields() {
        $ndar = new NDAR_Release('csbs');
        $fields = array('object_use_weighted',
            'Candidate_Age',
            'date_coded_date',
            'relationship_to_child',
            'q_1_alertness',
            'q_2_emotional_reaction',
            'q_3_level_of_interest',
            'q_4_comfort_level',
            'q_5_level_of_activity',
            'q_6_level_of_communication',
            'q_7_play_behaviour',
            'comments',
            'emotion_eye_gaze_standard',
            'emotion_eye_gaze_percentile',
            'communication_standard',
            'communication_percentile',
            'gestures_standard',
            'gestures_percentile',
            'sounds_standard',
            'sounds_percentile',
            'words_standard',
            'words_percentile',
            'understanding_standard',
            'understanding_percentile',
            'object_use_standard',
            'object_use_percentile',
            'social_composite_score',
            'social_composite_standard',
            'social_composite_percentile',
            'speech_composite_score',
            'speech_composite_standard',
            'speech_composite_percentile',
            'symbolic_composite_score',
            'symbolic_composite_standard',
            'symbolic_composite_percentile',
            'total_weighted_raw_score',
            'total_standard',
            'total_percentile',
            'q_1_gaze_shifts_1',
            'q_1_gaze_shifts_2',
            'q_1_gaze_shifts_3',
            'q_1_gaze_shifts_4',
            'q_1_gaze_shifts_5',
            'q_1_gaze_shifts_6',
            'q_1_gaze_shifts_raw_score',
            'q_2_shared_positive_affect_1',
            'q_2_shared_positive_affect_2',
            'q_2_shared_positive_affect_3',
            'q_2_shared_positive_affect_4',
            'q_2_shared_positive_affect_5',
            'q_2_shared_positive_affect_6',
            'q_2_shared_positive_affect_raw_score',
            'q_3_gaze_point_following_2',
            'q_3_gaze_point_following_5',
            'q_3_gaze_point_following_raw_score',
            'emotion_eye_gaze_weighted',
            'q_4_rate_of_communicating_1',
            'q_4_rate_of_communicating_2',
            'q_4_rate_of_communicating_3',
            'q_4_rate_of_communicating_4',
            'q_4_rate_of_communicating_5',
            'q_4_rate_of_communicating_6',
            'q_4_rate_of_communicating_raw_score',
            'q_5_behaviour_regulation_1',
            'q_5_behaviour_regulation_2',
            'q_5_behaviour_regulation_3',
            'q_5_behaviour_regulation_4',
            'q_5_behaviour_regulation_5',
            'q_5_behaviour_regulation_6',
            'q_5_behaviour_regulation_raw_score',
            'q_6_social_interaction_1',
            'q_6_social_interaction_2',
            'q_6_social_interaction_3',
            'q_6_social_interaction_4',
            'q_6_social_interaction_5',
            'q_6_social_interaction_6',
            'q_6_social_interaction_raw_score',
            'q_7_joint_attention_1',
            'q_7_joint_attention_2',
            'q_7_joint_attention_3',
            'q_7_joint_attention_4',
            'q_7_joint_attention_5',
            'q_7_joint_attention_6',
            'q_7_joint_attention_raw_score',
            'communication_weighted',
            'q_8_conventional_gestures_gives',
            'q_8_conventional_gestures_shows',
            'q_8_conventional_gestures_pushes_pulls',
            'q_8_conventional_gestures_reaches',
            'q_8_conventional_gestures_raw_score',
            'q_8_conventional_gestures_points',
            'q_8_conventional_gestures_waves',
            'q_8_conventional_gestures_nods_head',
            'q_8_conventional_gestures_shakes_head',
            'q_9_distal_gestures_1',
            'q_9_distal_gestures_2',
            'q_9_distal_gestures_3',
            'q_9_distal_gestures_4',
            'q_9_distal_gestures_5',
            'q_9_distal_gestures_6',
            'q_9_distal_gestures_raw_score',
            'gestures_weighted',
            'q_10_syllables_consonants_1',
            'q_10_syllables_consonants_2',
            'q_10_syllables_consonants_3',
            'q_10_syllables_consonants_4',
            'q_10_syllables_consonants_5',
            'q_10_syllables_consonants_6',
            'q_10_syllables_consonants_raw_score',
            'q_11_inventory_of_consonants_m',
            'q_11_inventory_of_consonants_n',
            'q_11_inventory_of_consonants_b_p',
            'q_11_inventory_of_consonants_d_t',
            'q_11_inventory_of_consonants_g_k',
            'q_11_inventory_of_consonants_raw_score',
            'q_11_inventory_of_consonants_w',
            'q_11_inventory_of_consonants_l',
            'q_11_inventory_of_consonants_y',
            'q_11_inventory_of_consonants_s',
            'q_11_inventory_of_consonants_sh',
            'sounds_weighted',
            'q_12_words_1',
            'q_12_words_2',
            'q_12_words_3',
            'q_12_words_4',
            'q_12_words_5',
            'q_12_words_6',
            'q_12_words_raw_score',
            'q_13_words_1',
            'q_13_words_2',
            'q_13_words_3',
            'q_13_words_4',
            'q_13_words_raw_score',
            'q_13_words_5',
            'q_13_words_6',
            'q_13_words_7',
            'q_13_words_8',
            'q_13_words_9',
            'q_13_words_10',
            'q_13_words_11',
            'q_13_words_12',
            'q_13_words_13',
            'q_13_words_14',
            'q_13_words_15',
            'q_13_words_16',
            'q_14_word_combos_1',
            'q_14_word_combos_2',
            'q_14_word_combos_3',
            'q_14_word_combos_4',
            'q_14_word_combos_5',
            'q_14_word_combos_6',
            'q_14_word_combos_raw_score',
            'q_15_word_combos_1',
            'q_15_word_combos_2',
            'q_15_word_combos_raw_score',
            'q_15_word_combos_3',
            'q_15_word_combos_4',
            'q_15_word_combos_5',
            'q_15_word_combos_6',
            'q_16_language_comp_raw_score',
            'q_15_word_combos_7',
            'q_15_word_combos_8',
            'words_weighted',
            'wind_up_admin',
            'q_16_language_comp_objects_1_name',
            'balloon_admin',
            'q_16_language_comp_objects_1',
            'bubbles_admin',
            'q_16_language_comp_objects_2_name',
            'jar_admin',
            'q_16_language_comp_objects_2',
            'books_admin',
            'q_16_language_comp_objects_3_name',
            'play_admin',
            'q_16_language_comp_objects_3',
            'q_16_language_comp_objects_4_name',
            'q_16_language_comp_objects_4',
            'q_16_language_comp_person_1_name',
            'q_16_language_comp_person_1',
            'q_16_language_comp_person_2_name',
            'q_16_language_comp_person_2',
            'q_16_language_comp_person_3_name',
            'q_16_language_comp_person_3',
            'q_16_language_comp_body_parts_1_name',
            'q_16_language_comp_body_parts_1',
            'q_16_language_comp_body_parts_2_name',
            'q_16_language_comp_body_parts_2',
            'q_16_language_comp_body_parts_3_name',
            'q_16_language_comp_body_parts_3',
            'q_16_language_comp_body_parts_4_name',
            'q_16_language_comp_body_parts_4',
            'understanding_weighted',
            'q_17_action_schemes_puts_in',
            'q_17_action_schemes_puts_on',
            'q_17_action_schemes_drinks_with_bottle',
            'q_17_action_schemes_drinks_with_cup',
            'q_18_actions_towards_other_raw_score',
            'q_17_action_schemes_hugs',
            'q_17_action_schemes_kisses',
            'q_17_action_schemes_feeds_with_utensil',
            'q_17_action_schemes_feeds_with_bowl',
            'q_17_action_schemes_stirs',
            'q_17_action_schemes_scoops',
            'q_17_action_schemes_pours',
            'q_19_sequence_action_schemes_raw_score',
            'q_17_action_schemes_other',
            'q_17_action_schemes_other_specify',
            'q_17_action_schemes_none',
            'q_17_action_schemes_raw_score',
            'q_18_action_towards_other_1',
            'q_18_action_towards_other_1_agent',
            'q_18_action_towards_other_1_agent_specify',
            'q_18_action_towards_other_2',
            'q_18_action_towards_other_2_agent',
            'q_18_action_towards_other_2_agent_specify',
            'q_18_action_towards_other_3',
            'q_18_action_towards_other_3_agent',
            'q_18_action_towards_other_3_agent_specify',
            'q_18_action_towards_other_4',
            'q_18_action_towards_other_4_agent',
            'q_18_action_towards_other_4_agent_specify',
            'q_18_action_towards_other_5',
            'q_18_action_towards_other_5_agent',
            'q_18_action_towards_other_5_agent_specify',
            'q_18_action_towards_other_6',
            'q_18_action_towards_other_6_agent',
            'q_18_action_towards_other_6_agent_specify',
            'q_19_sequence_action_schemes_1_action1',
            'q_19_sequence_action_schemes_1_action2',
            'q_19_sequence_action_schemes_2_action1',
            'q_19_sequence_action_schemes_2_action2',
            'q_19_sequence_action_schemes_3_action1',
            'q_19_sequence_action_schemes_3_action2',
            'q_19_sequence_action_schemes_4_action1',
            'q_19_sequence_action_schemes_4_action2',
            'q_19_sequence_action_schemes_5_action1',
            'q_19_sequence_action_schemes_5_action2',
            'q_19_sequence_action_schemes_6_action1',
            'q_19_sequence_action_schemes_6_action2',
            'q_20_stacks_tower',
            'q_20_stacks_tower_raw_score');
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' f.Validity, i.Date_taken, i.' . implode($fields, ', i.'));
    }

    function testIBQRFields() {
        $ndar = new NDAR_Release('ibq_r');
        $fields = 'i.Candidate_Age, i.activity_level, i.approach, i.cuddliness, i.distress_to_limitations, i.duration_of_orienting, i.falling_reactivity, i.fear, i.high_pleasure, i.low_pleasure, i.perceptual_sensitivity, i.sadness, i.smiling_and_laughter, i.soothability, i.vocal_reactivity, i.q_1, i.q_10, i.q_100, i.q_101, i.q_102, i.q_103, i.q_104, i.q_105, i.q_106, i.q_107, i.q_108, i.q_109, i.q_11, i.q_110, i.q_111, i.q_112, i.q_113, i.q_114, i.q_115, i.q_116, i.q_117, i.q_118, i.q_119, i.q_12, i.q_120, i.q_121, i.q_122, i.q_123, i.q_124, i.q_125, i.q_126, i.q_127, i.q_128, i.q_129, i.q_13, i.q_130, i.q_131, i.q_132, i.q_133, i.q_134, i.q_135, i.q_136, i.q_137, i.q_138, i.q_139, i.q_14, i.q_140, i.q_141, i.q_142, i.q_143, i.q_144, i.q_145, i.q_146, i.q_147, i.q_148, i.q_149, i.q_15, i.q_150, i.q_151, i.q_152, i.q_153, i.q_154, i.q_155, i.q_156, i.q_157, i.q_158, i.q_159, i.q_16, i.q_160, i.q_161, i.q_162, i.q_163, i.q_164, i.q_165, i.q_166, i.q_167, i.q_168, i.q_169, i.q_17, i.q_170, i.q_171, i.q_172, i.q_173, i.q_174, i.q_175, i.q_176, i.q_177, i.q_178, i.q_179, i.q_18, i.q_180, i.q_181, i.q_182, i.q_183, i.q_184, i.q_185, i.q_186, i.q_187, i.q_188, i.q_189, i.q_19, i.q_190, i.q_191, i.q_2, i.q_20, i.q_21, i.q_22, i.q_23, i.q_24, i.q_25, i.q_26, i.q_27, i.q_28, i.q_29, i.q_3, i.q_30, i.q_31, i.q_32, i.q_33, i.q_34, i.q_35, i.q_36, i.q_37, i.q_38, i.q_39, i.q_4, i.q_40, i.q_41, i.q_42, i.q_43, i.q_44, i.q_45, i.q_46, i.q_47, i.q_48, i.q_49, i.q_5, i.q_50, i.q_51, i.q_52, i.q_53, i.q_54, i.q_55, i.q_56, i.q_57, i.q_58, i.q_59, i.q_6, i.q_60, i.q_61, i.q_62, i.q_63, i.q_64, i.q_65, i.q_66, i.q_67, i.q_68, i.q_69, i.q_7, i.q_70, i.q_71, i.q_72, i.q_73, i.q_74, i.q_75, i.q_76, i.q_77, i.q_78, i.q_79, i.q_8, i.q_80, i.q_81, i.q_82, i.q_83, i.q_84, i.q_85, i.q_86, i.q_87, i.q_88, i.q_89, i.q_9, i.q_90, i.q_91, i.q_92, i.q_93, i.q_94, i.q_95, i.q_96, i.q_97, i.q_98, i.q_99';
        $this->assertEqual($ndar->getFields(), $this->CommonCandidateFields . ' i.Date_taken, ' . $fields);

    }
    function testADIRQuery() {
        $ndar = new NDAR_Release('adi_r_proband');
        $this->assertEqual($ndar->getQuery(), 'SELECT ' . $ndar->getFields() . ' FROM adi_r_proband i JOIN flag f ON (f.CommentID=i.CommentID) JOIN session s ON (s.ID=f.SessionID) JOIN candidate c ON (c.CandID=s.CandID) WHERE ' . $ndar->getWhere());

    }

    function testRun() {
        // Once for adi_r_proband, and twice for scq_proband and scq_subject
        $this->db->expectCallCount('pselect', 5);

        $ndar = new NDAR_Release_Partial('adi_r_proband');
        // Constructor doesn't get called since it's a partial, so call it manually
        $ndar->__construct('adi_r_proband');
        $ndar->expectOnce('getQuery');
        $ndar->expectOnce('process');
        $ndar->expectOnce('writeResults', array('*', './adi_r_proband.csv'));
        $ndar->run();
        $ndar = new NDAR_Release_Partial('scq_proband');
        $ndar->__construct('scq_proband');
        // Calls getQuery once, then adds the scq_version=lifetime and runs the query twice
        $ndar->expectOnce('getQuery');
        $ndar->expectCallCount('process', 2);
        $ndar->expectAt(0, 'writeResults', array('*', './scq_proband_lifetime.csv'));
        $ndar->expectAt(1, 'writeResults', array('*', './scq_proband_current.csv'));
        $ndar->expectCallCount('writeResults', 2);
        $ndar->run();
        $ndar = new NDAR_Release_Partial('scq_subject');
        $ndar->__construct('scq_subject');
        $ndar->expectOnce('getQuery');
        $ndar->expectCallCount('process', 2);
        $ndar->expectAt(0, 'writeResults', array('*', './scq_subject_lifetime.csv'));
        $ndar->expectAt(1, 'writeResults', array('*', './scq_subject_current.csv'));
        $ndar->expectCallCount('writeResults', 2);
        $ndar->run();
    }

    function testADIRProcess() {
        $ndar = new NDAR_Release('adi_r_proband');
        $FakeRows = array(
            0 => array(
                'IBISID' => 'IBIS8368',
                'ProbandGUID' => 'NDARAH978FW6',
                'Validity' => '',
                'Date_taken' => '2008-06-16',
                'A_Total' => '11',
                'BNV_Total' => 'Verbal',
                'BV_Total' => '12',
                'C_Total' => '9',
                'D_Total' => '3',
                'Total_A1' => '3',
                'Total_A2' => '5',
                'Total_A3' => '0',
                'Total_A4' => '3',
                'Total_B1' => '1',
                'Total_B2V' => '3',
                'Total_B3V' => '6',
                'Total_B4' => '2',
                'Total_C1' => '4',
                'Total_C2' => '2',
                'Total_C3' => '2',
                'Total_C4' => '1',
                'summary_diagnosis' => 'ASD+',
                'informant_relation' => '0_mom',
                'q_2_age_first_noticed_code' => '25',
                'q_4_onset_as_perceived_code' => '0',
                'q_5_first_walked_code' => '14',
                'q_6_bladder_daytime_code' => '54',
                'q_7_bladder_nighttime_code' => '54',
                'q_8_bowel_control_code' => '54',
                'q_9_first_single_words_code' => '24',
                'q_10_first_phrases_code' => '29',
                'q_11_loss_of_language' => '0_no',
                'q_12_level_before_loss_code' => '9_not_asked',
                'q_13_loss_of_spontaneous_use_code' => '9_not_asked',
                'q_14_loss_of_intent_code' => '9_not_asked',
                'q_15_loss_of_syntactical_code' => '9_not_asked',
                'q_16_loss_of_articulation_code' => '9_not_asked',
                'q_17_main_loss_apparent_code' => '999',
                'q_18_loss_due_to_illness' => '9_not_asked',
                'q_19_duration_of_loss_code' => '999',
                'q_20_loss_of_skills_code' => '0_no_consistent_loss',
                'q_21_puposive_hand_movements_code' => '0_none',
                'q_22_motor_skills_code' => '0_none',
                'q_23_self_help_skills_code' => '0_none',
                'q_24_constructive_play_code' => '0_none',
                'q_25_social_engagement_code' => '0_none',
                'q_26_loss_first_apparent_code' => '999',
                'q_27_physical_illness_code' => '9_not_asked',
                'q_28_duration_of_loss_code' => '999',
                'q_29_compreh_simple_current' => '2_understand_many_words',
                'q_29_compreh_simple_most_abnormal' => '2_understand_many_words',
                'q_30_overall_level_of_language' => '0_fuctional',
                'q_31_use_of_others_body_current_code' => '0_no_use',
                'q_31_use_of_others_body_ever_code' => '0_no_use',
                'q_32_artic_pronun_5years_code' => '8_NA',
                'q_32_artic_pronun_current_code' => '0_anybody',
                'q_33_stereotyped_utterances_current_code' => '2_often_stereotyped',
                'q_33_stereotyped_utterances_ever_code' => '2_often_stereotyped',
                'q_34_social_verb_chat_current_code' => '1_some_response',
                'q_34_social_verb_chat_ever_code' => '1_some_response',
                'q_35_recipr_convers_current_code' => '1_occasional',
                'q_35_recipr_convers_ever_code' => '2_little_or_not',
                'q_36_inappropriate_qs_current_code' => '1_some_questions',
                'q_36_inappropriate_qs_ever_code' => '0_none_or_rare',
                'q_37_prenominal_reversal_current_code' => '2_you_I_confusion',
                'q_37_prenominal_reversal_ever_code' => '2_you_I_confusion',
                'q_38_neologisms_current_code' => '2_regular',
                'q_38_neologisms_ever_code' => '2_regular',
                'q_39_verbal_rituals_current_code' => '2_special_way',
                'q_39_verbal_rituals_ever_code' => '2_special_way',
                'q_40_inton_vol_rhythm_rate_current_code' => '1_shows_abnormalities',
                'q_40_inton_vol_rhythm_rate_ever_code' => '1_shows_abnormalities',
                'q_41_cur_comm_speech_at5_code' => '8_NA',
                'q_41_cur_comm_speech_current_code' => '0_speech_used_frequently',
                'q_42_point_express_inter_most_abnormal_code' => '0_spontaneously',
                'q_42_point_express_interest_current_code' => '0_spontaneously',
                'q_43_nodding_current_code' => '0_consistently',
                'q_43_nodding_most_abnormal_code' => '0_consistently',
                'q_44_head_shaking_current_code' => '0_consistently',
                'q_44_head_shaking_most_abnormal_code' => '0_consistently',
                'q_45_conventional_instr_gests_current_code' => '1_spontaneous',
                'q_45_conventional_instr_gests_most_abnormal_code' => '1_spontaneous',
                'q_46_attent_voice_current_code' => '0_usually',
                'q_46_attent_voice_most_abnormal_code' => '0_usually',
                'q_47_spont_imit_current_code' => '0_spontaneous',
                'q_47_spont_imit_most_abnormal_code' => '0_spontaneous',
                'q_48_imag_play_current_code' => '1_some',
                'q_48_imag_play_most_abnormal_code' => '1_some',
                'q_49_imag_play_peers_current_code' => '2_some_play',
                'q_49_imag_play_peers_most_abnormal_code' => '2_some_play',
                'q_50_direct_gaze_current_code' => '3_unusual',
                'q_50_direct_gaze_most_abnormal_code' => '3_unusual',
                'q_51_social_smiling_current_code' => '1_some_reciprocal',
                'q_51_social_smiling_most_abnormal_code' => '1_some_reciprocal',
                'q_52_show_direct_atten_current_code' => '0_regular',
                'q_52_show_direct_atten_most_abnormal_code' => '0_regular',
                'q_53_offer_share_current_code' => '0_frequent',
                'q_53_offer_share_most_abnormal_code' => '0_frequent',
                'q_54_seek_share_enjoy_current_code' => '0_frequent',
                'q_54_seek_share_enjoy_most_abnormal_code' => '0_frequent',
                'q_55_offer_comf_current_code' => '1_partial',
                'q_55_offer_comf_most_abnormal_code' => '1_partial',
                'q_56_qual_social_overts_current_code' => '0_consistently',
                'q_56_qual_social_overts_most_abnormal_code' => '0_consistently',
                'q_57_range_facial_expr_current_code' => '0_full',
                'q_57_range_facial_expr_most_abnormal_code' => '0_full',
                'q_58_inappropriate_facial_current_code' => '0_almost_always',
                'q_58_inappropriate_facial_ever_code' => '0_almost_always',
                'q_59_appropriat_resp_current_code' => '2_responds',
                'q_59_appropriat_resp_most_abnormal_code' => '2_responds',
                'q_60_init_activities_current_code' => '1_initiates',
                'q_60_init_activities_most_abnormal_code' => '1_initiates',
                'q_61_imit_soc_play_current_code' => '1_some',
                'q_61_imit_soc_play_most_abnormal_code' => '1_some',
                'q_62_inter_children_current_code' => '0_often',
                'q_62_inter_children_most_abnormal_code' => '0_often',
                'q_63_resp_approaches_current_code' => '1_sometimes',
                'q_63_resp_approaches_most_abnormal_code' => '1_sometimes',
                'q_64_group_play_peers_current_code' => '2_enjoys',
                'q_64_group_play_peers_most_abnormal_code' => '2_enjoys',
                'q_65_friendships_current_code' => '8_NA',
                'q_65_friendships_most_abnormal_code' => '8_NA',
                'q_66_soc_disinhibit_current_code' => '2_lack',
                'q_66_soc_disinhibit_most_abnormal_code' => '2_lack',
                'q_67_unusual_preoccupations_current_code' => '2_definite_intrudes',
                'q_67_unusual_preoccupations_ever_code' => '2_definite_intrudes',
                'q_68_circumscr_ints_current_code' => '2_definite_no_interfere',
                'q_68_circumscr_ints_ever_code' => '2_definite_no_interfere',
                'q_69_repet_use_objects_current_code' => '1_some',
                'q_69_repet_use_objects_ever_code' => '1_some',
                'q_70_compulsions_rituals_current_code' => '0_no',
                'q_70_compulsions_rituals_ever_code' => '0_no',
                'q_71_unusual_sens_ints_current_code' => '0_no_unusual',
                'q_71_unusual_sens_ints_ever_code' => '0_no_unusual',
                'q_72_undo_gen_sens_noise_current_code' => '1_slight',
                'q_72_undo_gen_sens_noise_ever_code' => '2_definite_not_distressing',
                'q_73_idiosyncratic_current_code' => '2_occasional',
                'q_73_idiosyncratic_ever_code' => '2_occasional',
                'q_74_diff_minor_changes_current_code' => '0_no',
                'q_74_diff_minor_changes_ever_code' => '0_no',
                'q_75_resist_trivial_chng_current_code' => '2_avoid',
                'q_75_resist_trivial_chng_ever_code' => '2_avoid',
                'q_76_unus_attach_objects_current_code' => '0_no',
                'q_76_unus_attach_objects_ever_code' => '0_no',
                'q_77_hands_finger_manners_current_code' => '2_definite',
                'q_77_hands_finger_manners_ever_code' => '2_definite',
                'q_78_oth_complex_manners_current_code' => '0_no',
                'q_78_oth_complex_manners_ever_code' => '0_no',
                'q_79_midline_hand_moves_current_code' => '0_no',
                'q_79_midline_hand_moves_ever_code' => '0_no',
                'q_80_gait_current_code' => '1_somewhat',
                'q_80_gait_most_abnormal_code' => '0_normal',
                'q_81_aggress_caregivers_current_code' => '0_no',
                'q_81_aggress_caregivers_ever_code' => '0_no',
                'q_82_aggress_noncaregivers_current_code' => '0_rare',
                'q_82_aggress_noncaregivers_ever_code' => '0_rare',
                'q_83_self_injury_current_code' => '0_no',
                'q_83_self_injury_ever_code' => '0_no',
                'q_84_hyperventilation_current_code' => '0_no',
                'q_84_hyperventilation_ever_code' => '0_no',
                'q_85_faints_fits_blackouts_current_code' => '0_no',
                'q_85_faints_fits_blackouts_ever_code' => '0_no',
                'q_86_age_when_abnormality_first_evident' => '3',
                'q_87_interviewers_judgment' => '1',
                'q_88_visuospatial_ability_current_code' => '0_no',
                'q_88_visuospatial_ability_ever_code' => '0_no',
                'q_89_memory_still_current_code' => '0_no',
                'q_89_memory_still_ever_code' => '0_no',
                'q_90_musical_ability_current_code' => '0_no',
                'q_90_musical_ability_ever_code' => '0_no',
                'q_91_drawings_skill_current_code' => '0_no',
                'q_91_drawings_skill_ever_code' => '0_no',
                'q_92_reading_ability_current_code' => '0_no',
                'q_92_reading_ability_ever_code' => '0_no',
                'q_93_computational_ability_current_code' => '0_no',
                'q_93_computational_ability_ever_code' => '0_no'
            ),
            1 => array(
                'IBISID' => 'IBIS4956',
                'ProbandGUID' => 'NDARPT857GJ6',
                'Validity' => '',
                'Date_taken' => '2008-11-20',
                'A_Total' => '27',
                'BNV_Total' => '13',
                'BV_Total' => 'Nonverbal',
                'C_Total' => '10',
                'D_Total' => '3',
                'Total_A1' => '6',
                'Total_A2' => '7',
                'Total_A3' => '6',
                'Total_A4' => '8',
                'Total_B1' => '8',
                'Total_B2V' => 'Nonverbal',
                'Total_B3V' => 'Nonverbal',
                'Total_B4' => '5',
                'Total_C1' => '4',
                'Total_C2' => '2',
                'Total_C3' => '2',
                'Total_C4' => '2',
                'summary_diagnosis' => 'ASD+',
                'informant_relation' => '0_mom',
                'q_2_age_first_noticed_code' => '18',
                'q_4_onset_as_perceived_code' => '1',
                'q_5_first_walked_code' => '13',
                'q_6_bladder_daytime_code' => '995',
                'q_7_bladder_nighttime_code' => '994',
                'q_8_bowel_control_code' => '994',
                'q_9_first_single_words_code' => '12',
                'q_10_first_phrases_code' => '17',
                'q_11_loss_of_language' => '1_yes',
                'q_12_level_before_loss_code' => '0_daily',
                'q_13_loss_of_spontaneous_use_code' => '2_definite_loss',
                'q_14_loss_of_intent_code' => '2_definite_loss',
                'q_15_loss_of_syntactical_code' => '8_insufficient',
                'q_16_loss_of_articulation_code' => '0_no_loss',
                'q_17_main_loss_apparent_code' => '19',
                'q_18_loss_due_to_illness' => '0_loss_no_relevance',
                'q_19_duration_of_loss_code' => '993',
                'q_20_loss_of_skills_code' => '2_account_definite_loss',
                'q_21_puposive_hand_movements_code' => '0_none',
                'q_22_motor_skills_code' => '0_none',
                'q_23_self_help_skills_code' => '0_none',
                'q_24_constructive_play_code' => '1_possible',
                'q_25_social_engagement_code' => '2_definite',
                'q_26_loss_first_apparent_code' => '19',
                'q_27_physical_illness_code' => '0_no_relevance',
                'q_28_duration_of_loss_code' => '993',
                'q_29_compreh_simple_current' => '2_understand_many_words',
                'q_29_compreh_simple_most_abnormal' => '3_understand_fewer_than_50',
                'q_30_overall_level_of_language' => '1_no_functional',
                'q_31_use_of_others_body_current_code' => '2_occasional_for',
                'q_31_use_of_others_body_ever_code' => '2_occasional_for',
                'q_32_artic_pronun_5years_code' => '8_NA',
                'q_32_artic_pronun_current_code' => '8_NA',
                'q_33_stereotyped_utterances_current_code' => '8_NA',
                'q_33_stereotyped_utterances_ever_code' => '8_NA',
                'q_34_social_verb_chat_current_code' => '8_NA',
                'q_34_social_verb_chat_ever_code' => '8_NA',
                'q_35_recipr_convers_current_code' => '8_NA',
                'q_35_recipr_convers_ever_code' => '8_NA',
                'q_36_inappropriate_qs_current_code' => '8_NA',
                'q_36_inappropriate_qs_ever_code' => '8_NA',
                'q_37_prenominal_reversal_current_code' => '8_NA',
                'q_37_prenominal_reversal_ever_code' => '8_NA',
                'q_38_neologisms_current_code' => '8_NA',
                'q_38_neologisms_ever_code' => '8_NA',
                'q_39_verbal_rituals_current_code' => '8_NA',
                'q_39_verbal_rituals_ever_code' => '8_NA',
                'q_40_inton_vol_rhythm_rate_current_code' => '8_NA',
                'q_40_inton_vol_rhythm_rate_ever_code' => '8_NA',
                'q_41_cur_comm_speech_at5_code' => '8_NA',
                'q_41_cur_comm_speech_current_code' => '8_NA',
                'q_42_point_express_inter_most_abnormal_code' => '2_little_or_no',
                'q_42_point_express_interest_current_code' => '2_little_or_no',
                'q_43_nodding_current_code' => '2_never',
                'q_43_nodding_most_abnormal_code' => '2_never',
                'q_44_head_shaking_current_code' => '1_sometimes',
                'q_44_head_shaking_most_abnormal_code' => '2_never',
                'q_45_conventional_instr_gests_current_code' => '2_inconsistent',
                'q_45_conventional_instr_gests_most_abnormal_code' => '3_no_use',
                'q_46_attent_voice_current_code' => '8_NA',
                'q_46_attent_voice_most_abnormal_code' => '3_rarely',
                'q_47_spont_imit_current_code' => '2_limited',
                'q_47_spont_imit_most_abnormal_code' => '2_limited',
                'q_48_imag_play_current_code' => '1_some',
                'q_48_imag_play_most_abnormal_code' => '1_some',
                'q_49_imag_play_peers_current_code' => '2_some_play',
                'q_49_imag_play_peers_most_abnormal_code' => '2_some_play',
                'q_50_direct_gaze_current_code' => '8_NA',
                'q_50_direct_gaze_most_abnormal_code' => '2_uncertain',
                'q_51_social_smiling_current_code' => '2_some_smiling',
                'q_51_social_smiling_most_abnormal_code' => '3_little_or_no',
                'q_52_show_direct_atten_current_code' => '2_some',
                'q_52_show_direct_atten_most_abnormal_code' => '3_rare',
                'q_53_offer_share_current_code' => '2_sometimes',
                'q_53_offer_share_most_abnormal_code' => '2_sometimes',
                'q_54_seek_share_enjoy_current_code' => '2_few',
                'q_54_seek_share_enjoy_most_abnormal_code' => '2_few',
                'q_55_offer_comf_current_code' => '1_partial',
                'q_55_offer_comf_most_abnormal_code' => '1_partial',
                'q_56_qual_social_overts_current_code' => '2_rarely',
                'q_56_qual_social_overts_most_abnormal_code' => '2_rarely',
                'q_57_range_facial_expr_current_code' => '2_markedly',
                'q_57_range_facial_expr_most_abnormal_code' => '2_markedly',
                'q_58_inappropriate_facial_current_code' => '2_obviously',
                'q_58_inappropriate_facial_ever_code' => '2_obviously',
                'q_59_appropriat_resp_current_code' => '1_some',
                'q_59_appropriat_resp_most_abnormal_code' => '1_some',
                'q_60_init_activities_current_code' => '1_initiates',
                'q_60_init_activities_most_abnormal_code' => '3_no_active',
                'q_61_imit_soc_play_current_code' => '1_some',
                'q_61_imit_soc_play_most_abnormal_code' => '2_little',
                'q_62_inter_children_current_code' => '0_often',
                'q_62_inter_children_most_abnormal_code' => '1_usually',
                'q_63_resp_approaches_current_code' => '1_sometimes',
                'q_63_resp_approaches_most_abnormal_code' => '2_rarely',
                'q_64_group_play_peers_current_code' => '2_enjoys',
                'q_64_group_play_peers_most_abnormal_code' => '2_enjoys',
                'q_65_friendships_current_code' => '3_no_peer',
                'q_65_friendships_most_abnormal_code' => '8_NA',
                'q_66_soc_disinhibit_current_code' => '2_lack',
                'q_66_soc_disinhibit_most_abnormal_code' => '2_lack',
                'q_67_unusual_preoccupations_current_code' => '2_definite_intrudes',
                'q_67_unusual_preoccupations_ever_code' => '2_definite_intrudes',
                'q_68_circumscr_ints_current_code' => '3_definite_impairment',
                'q_68_circumscr_ints_ever_code' => '3_definite_impairment',
                'q_69_repet_use_objects_current_code' => '2_does_not_constrain',
                'q_69_repet_use_objects_ever_code' => '2_does_not_constrain',
                'q_70_compulsions_rituals_current_code' => '2_one_or_more',
                'q_70_compulsions_rituals_ever_code' => '2_one_or_more',
                'q_71_unusual_sens_ints_current_code' => '1_one_or_two',
                'q_71_unusual_sens_ints_ever_code' => '1_one_or_two',
                'q_72_undo_gen_sens_noise_current_code' => '2_definite_not_distressing',
                'q_72_undo_gen_sens_noise_ever_code' => '2_definite_not_distressing',
                'q_73_idiosyncratic_current_code' => '0_no',
                'q_73_idiosyncratic_ever_code' => '0_no',
                'q_74_diff_minor_changes_current_code' => '0_no',
                'q_74_diff_minor_changes_ever_code' => '0_no',
                'q_75_resist_trivial_chng_current_code' => '0_none',
                'q_75_resist_trivial_chng_ever_code' => '0_none',
                'q_76_unus_attach_objects_current_code' => '0_no',
                'q_76_unus_attach_objects_ever_code' => '0_no',
                'q_77_hands_finger_manners_current_code' => '2_definite',
                'q_77_hands_finger_manners_ever_code' => '2_definite',
                'q_78_oth_complex_manners_current_code' => '1_only',
                'q_78_oth_complex_manners_ever_code' => '2_definite',
                'q_79_midline_hand_moves_current_code' => '0_no',
                'q_79_midline_hand_moves_ever_code' => '0_no',
                'q_80_gait_current_code' => '2_defnitely',
                'q_80_gait_most_abnormal_code' => '2_defnitely',
                'q_81_aggress_caregivers_current_code' => '2_definite',
                'q_81_aggress_caregivers_ever_code' => '2_definite',
                'q_82_aggress_noncaregivers_current_code' => '2_definite',
                'q_82_aggress_noncaregivers_ever_code' => '2_definite',
                'q_83_self_injury_current_code' => '0_no',
                'q_83_self_injury_ever_code' => '0_no',
                'q_84_hyperventilation_current_code' => '1_occasional',
                'q_84_hyperventilation_ever_code' => '1_occasional',
                'q_85_faints_fits_blackouts_current_code' => '0_no',
                'q_85_faints_fits_blackouts_ever_code' => '0_no',
                'q_86_age_when_abnormality_first_evident' => '4',
                'q_87_interviewers_judgment' => '19',
                'q_88_visuospatial_ability_current_code' => '7_meaningful',
                'q_88_visuospatial_ability_ever_code' => '7_meaningful',
                'q_89_memory_still_current_code' => '7_meaningful',
                'q_89_memory_still_ever_code' => '7_meaningful',
                'q_90_musical_ability_current_code' => '0_no',
                'q_90_musical_ability_ever_code' => '0_no',
                'q_91_drawings_skill_current_code' => '0_no',
                'q_91_drawings_skill_ever_code' => '0_no',
                'q_92_reading_ability_current_code' => '2_above_population',
                'q_92_reading_ability_ever_code' => '2_above_population',
                'q_93_computational_ability_current_code' => '0_no',
                'q_93_computational_ability_ever_code' => '0_no'
            )
        );
        $FakeResults = array(
            0 => array(
                'IBISID' => 'IBIS8368',
                'ProbandGUID' => 'NDARAH978FW6',
                'Validity' => '',
                'Date_taken' => '06/01/2008',
                'A_Total' => '11',
                'BNV_Total' => '',
                'BV_Total' => '12',
                'C_Total' => '9',
                'D_Total' => '3',
                'Total_A1' => '3',
                'Total_A2' => '5',
                'Total_A3' => '0',
                'Total_A4' => '3',
                'Total_B1' => '1',
                'Total_B2V' => '3',
                'Total_B3V' => '6',
                'Total_B4' => '2',
                'Total_C1' => '4',
                'Total_C2' => '2',
                'Total_C3' => '2',
                'Total_C4' => '1',
                'summary_diagnosis' => 'ASD+',
                'informant_relation' => '0',
                'q_2_age_first_noticed_code' => '25',
                'q_4_onset_as_perceived_code' => '0',
                'q_5_first_walked_code' => '14',
                'q_6_bladder_daytime_code' => '54',
                'q_7_bladder_nighttime_code' => '54',
                'q_8_bowel_control_code' => '54',
                'q_9_first_single_words_code' => '24',
                'q_10_first_phrases_code' => '29',
                'q_11_loss_of_language' => '0',
                'q_12_level_before_loss_code' => '9',
                'q_13_loss_of_spontaneous_use_code' => '9',
                'q_14_loss_of_intent_code' => '9',
                'q_15_loss_of_syntactical_code' => '9',
                'q_16_loss_of_articulation_code' => '9',
                'q_17_main_loss_apparent_code' => '999',
                'q_18_loss_due_to_illness' => '9',
                'q_19_duration_of_loss_code' => '999',
                'q_20_loss_of_skills_code' => '0',
                'q_21_puposive_hand_movements_code' => '0',
                'q_22_motor_skills_code' => '0',
                'q_23_self_help_skills_code' => '0',
                'q_24_constructive_play_code' => '0',
                'q_25_social_engagement_code' => '0',
                'q_26_loss_first_apparent_code' => '999',
                'q_27_physical_illness_code' => '9',
                'q_28_duration_of_loss_code' => '999',
                'q_29_compreh_simple_current' => '2',
                'q_29_compreh_simple_most_abnormal' => '2',
                'q_30_overall_level_of_language' => '0',
                'q_31_use_of_others_body_current_code' => '0',
                'q_31_use_of_others_body_ever_code' => '0',
                'q_32_artic_pronun_5years_code' => '8',
                'q_32_artic_pronun_current_code' => '0',
                'q_33_stereotyped_utterances_current_code' => '2',
                'q_33_stereotyped_utterances_ever_code' => '2',
                'q_34_social_verb_chat_current_code' => '1',
                'q_34_social_verb_chat_ever_code' => '1',
                'q_35_recipr_convers_current_code' => '1',
                'q_35_recipr_convers_ever_code' => '2',
                'q_36_inappropriate_qs_current_code' => '1',
                'q_36_inappropriate_qs_ever_code' => '0',
                'q_37_prenominal_reversal_current_code' => '2',
                'q_37_prenominal_reversal_ever_code' => '2',
                'q_38_neologisms_current_code' => '2',
                'q_38_neologisms_ever_code' => '2',
                'q_39_verbal_rituals_current_code' => '2',
                'q_39_verbal_rituals_ever_code' => '2',
                'q_40_inton_vol_rhythm_rate_current_code' => '1',
                'q_40_inton_vol_rhythm_rate_ever_code' => '1',
                'q_41_cur_comm_speech_at5_code' => '8',
                'q_41_cur_comm_speech_current_code' => '0',
                'q_42_point_express_inter_most_abnormal_code' => '0',
                'q_42_point_express_interest_current_code' => '0',
                'q_43_nodding_current_code' => '0',
                'q_43_nodding_most_abnormal_code' => '0',
                'q_44_head_shaking_current_code' => '0',
                'q_44_head_shaking_most_abnormal_code' => '0',
                'q_45_conventional_instr_gests_current_code' => '1',
                'q_45_conventional_instr_gests_most_abnormal_code' => '1',
                'q_46_attent_voice_current_code' => '0',
                'q_46_attent_voice_most_abnormal_code' => '0',
                'q_47_spont_imit_current_code' => '0',
                'q_47_spont_imit_most_abnormal_code' => '0',
                'q_48_imag_play_current_code' => '1',
                'q_48_imag_play_most_abnormal_code' => '1',
                'q_49_imag_play_peers_current_code' => '2',
                'q_49_imag_play_peers_most_abnormal_code' => '2',
                'q_50_direct_gaze_current_code' => '3',
                'q_50_direct_gaze_most_abnormal_code' => '3',
                'q_51_social_smiling_current_code' => '1',
                'q_51_social_smiling_most_abnormal_code' => '1',
                'q_52_show_direct_atten_current_code' => '0',
                'q_52_show_direct_atten_most_abnormal_code' => '0',
                'q_53_offer_share_current_code' => '0',
                'q_53_offer_share_most_abnormal_code' => '0',
                'q_54_seek_share_enjoy_current_code' => '0',
                'q_54_seek_share_enjoy_most_abnormal_code' => '0',
                'q_55_offer_comf_current_code' => '1',
                'q_55_offer_comf_most_abnormal_code' => '1',
                'q_56_qual_social_overts_current_code' => '0',
                'q_56_qual_social_overts_most_abnormal_code' => '0',
                'q_57_range_facial_expr_current_code' => '0',
                'q_57_range_facial_expr_most_abnormal_code' => '0',
                'q_58_inappropriate_facial_current_code' => '0',
                'q_58_inappropriate_facial_ever_code' => '0',
                'q_59_appropriat_resp_current_code' => '2',
                'q_59_appropriat_resp_most_abnormal_code' => '2',
                'q_60_init_activities_current_code' => '1',
                'q_60_init_activities_most_abnormal_code' => '1',
                'q_61_imit_soc_play_current_code' => '1',
                'q_61_imit_soc_play_most_abnormal_code' => '1',
                'q_62_inter_children_current_code' => '0',
                'q_62_inter_children_most_abnormal_code' => '0',
                'q_63_resp_approaches_current_code' => '1',
                'q_63_resp_approaches_most_abnormal_code' => '1',
                'q_64_group_play_peers_current_code' => '2',
                'q_64_group_play_peers_most_abnormal_code' => '2',
                'q_65_friendships_current_code' => '8',
                'q_65_friendships_most_abnormal_code' => '8',
                'q_66_soc_disinhibit_current_code' => '2',
                'q_66_soc_disinhibit_most_abnormal_code' => '2',
                'q_67_unusual_preoccupations_current_code' => '2',
                'q_67_unusual_preoccupations_ever_code' => '2',
                'q_68_circumscr_ints_current_code' => '2',
                'q_68_circumscr_ints_ever_code' => '2',
                'q_69_repet_use_objects_current_code' => '1',
                'q_69_repet_use_objects_ever_code' => '1',
                'q_70_compulsions_rituals_current_code' => '0',
                'q_70_compulsions_rituals_ever_code' => '0',
                'q_71_unusual_sens_ints_current_code' => '0',
                'q_71_unusual_sens_ints_ever_code' => '0',
                'q_72_undo_gen_sens_noise_current_code' => '1',
                'q_72_undo_gen_sens_noise_ever_code' => '2',
                'q_73_idiosyncratic_current_code' => '2',
                'q_73_idiosyncratic_ever_code' => '2',
                'q_74_diff_minor_changes_current_code' => '0',
                'q_74_diff_minor_changes_ever_code' => '0',
                'q_75_resist_trivial_chng_current_code' => '2',
                'q_75_resist_trivial_chng_ever_code' => '2',
                'q_76_unus_attach_objects_current_code' => '0',
                'q_76_unus_attach_objects_ever_code' => '0',
                'q_77_hands_finger_manners_current_code' => '2',
                'q_77_hands_finger_manners_ever_code' => '2',
                'q_78_oth_complex_manners_current_code' => '0',
                'q_78_oth_complex_manners_ever_code' => '0',
                'q_79_midline_hand_moves_current_code' => '0',
                'q_79_midline_hand_moves_ever_code' => '0',
                'q_80_gait_current_code' => '1',
                'q_80_gait_most_abnormal_code' => '0',
                'q_81_aggress_caregivers_current_code' => '0',
                'q_81_aggress_caregivers_ever_code' => '0',
                'q_82_aggress_noncaregivers_current_code' => '0',
                'q_82_aggress_noncaregivers_ever_code' => '0',
                'q_83_self_injury_current_code' => '0',
                'q_83_self_injury_ever_code' => '0',
                'q_84_hyperventilation_current_code' => '0',
                'q_84_hyperventilation_ever_code' => '0',
                'q_85_faints_fits_blackouts_current_code' => '0',
                'q_85_faints_fits_blackouts_ever_code' => '0',
                'q_86_age_when_abnormality_first_evident' => '3',
                'q_87_interviewers_judgment' => '1',
                'q_88_visuospatial_ability_current_code' => '0',
                'q_88_visuospatial_ability_ever_code' => '0',
                'q_89_memory_still_current_code' => '0',
                'q_89_memory_still_ever_code' => '0',
                'q_90_musical_ability_current_code' => '0',
                'q_90_musical_ability_ever_code' => '0',
                'q_91_drawings_skill_current_code' => '0',
                'q_91_drawings_skill_ever_code' => '0',
                'q_92_reading_ability_current_code' => '0',
                'q_92_reading_ability_ever_code' => '0',
                'q_93_computational_ability_current_code' => '0',
                'q_93_computational_ability_ever_code' => '0',
                'subject_verbal' => 'yes'
            ),
            1 => array(
                'IBISID' => 'IBIS4956',
                'ProbandGUID' => 'NDARPT857GJ6',
                'Validity' => '',
                'Date_taken' => '11/01/2008',
                'A_Total' => '27',
                'BNV_Total' => '13',
                'BV_Total' => '',
                'C_Total' => '10',
                'D_Total' => '3',
                'Total_A1' => '6',
                'Total_A2' => '7',
                'Total_A3' => '6',
                'Total_A4' => '8',
                'Total_B1' => '8',
                'Total_B2V' => '',
                'Total_B3V' => '',
                'Total_B4' => '5',
                'Total_C1' => '4',
                'Total_C2' => '2',
                'Total_C3' => '2',
                'Total_C4' => '2',
                'summary_diagnosis' => 'ASD+',
                'informant_relation' => '0',
                'q_2_age_first_noticed_code' => '18',
                'q_4_onset_as_perceived_code' => '1',
                'q_5_first_walked_code' => '13',
                'q_6_bladder_daytime_code' => '995',
                'q_7_bladder_nighttime_code' => '994',
                'q_8_bowel_control_code' => '994',
                'q_9_first_single_words_code' => '12',
                'q_10_first_phrases_code' => '17',
                'q_11_loss_of_language' => '1',
                'q_12_level_before_loss_code' => '0',
                'q_13_loss_of_spontaneous_use_code' => '2',
                'q_14_loss_of_intent_code' => '2',
                'q_15_loss_of_syntactical_code' => '8',
                'q_16_loss_of_articulation_code' => '0',
                'q_17_main_loss_apparent_code' => '19',
                'q_18_loss_due_to_illness' => '0',
                'q_19_duration_of_loss_code' => '993',
                'q_20_loss_of_skills_code' => '2',
                'q_21_puposive_hand_movements_code' => '0',
                'q_22_motor_skills_code' => '0',
                'q_23_self_help_skills_code' => '0',
                'q_24_constructive_play_code' => '1',
                'q_25_social_engagement_code' => '2',
                'q_26_loss_first_apparent_code' => '19',
                'q_27_physical_illness_code' => '0',
                'q_28_duration_of_loss_code' => '993',
                'q_29_compreh_simple_current' => '2',
                'q_29_compreh_simple_most_abnormal' => '3',
                'q_30_overall_level_of_language' => '1',
                'q_31_use_of_others_body_current_code' => '2',
                'q_31_use_of_others_body_ever_code' => '2',
                'q_32_artic_pronun_5years_code' => '8',
                'q_32_artic_pronun_current_code' => '8',
                'q_33_stereotyped_utterances_current_code' => '8',
                'q_33_stereotyped_utterances_ever_code' => '8',
                'q_34_social_verb_chat_current_code' => '8',
                'q_34_social_verb_chat_ever_code' => '8',
                'q_35_recipr_convers_current_code' => '8',
                'q_35_recipr_convers_ever_code' => '8',
                'q_36_inappropriate_qs_current_code' => '8',
                'q_36_inappropriate_qs_ever_code' => '8',
                'q_37_prenominal_reversal_current_code' => '8',
                'q_37_prenominal_reversal_ever_code' => '8',
                'q_38_neologisms_current_code' => '8',
                'q_38_neologisms_ever_code' => '8',
                'q_39_verbal_rituals_current_code' => '8',
                'q_39_verbal_rituals_ever_code' => '8',
                'q_40_inton_vol_rhythm_rate_current_code' => '8',
                'q_40_inton_vol_rhythm_rate_ever_code' => '8',
                'q_41_cur_comm_speech_at5_code' => '8',
                'q_41_cur_comm_speech_current_code' => '8',
                'q_42_point_express_inter_most_abnormal_code' => '2',
                'q_42_point_express_interest_current_code' => '2',
                'q_43_nodding_current_code' => '2',
                'q_43_nodding_most_abnormal_code' => '2',
                'q_44_head_shaking_current_code' => '1',
                'q_44_head_shaking_most_abnormal_code' => '2',
                'q_45_conventional_instr_gests_current_code' => '2',
                'q_45_conventional_instr_gests_most_abnormal_code' => '3',
                'q_46_attent_voice_current_code' => '8',
                'q_46_attent_voice_most_abnormal_code' => '3',
                'q_47_spont_imit_current_code' => '2',
                'q_47_spont_imit_most_abnormal_code' => '2',
                'q_48_imag_play_current_code' => '1',
                'q_48_imag_play_most_abnormal_code' => '1',
                'q_49_imag_play_peers_current_code' => '2',
                'q_49_imag_play_peers_most_abnormal_code' => '2',
                'q_50_direct_gaze_current_code' => '8',
                'q_50_direct_gaze_most_abnormal_code' => '2',
                'q_51_social_smiling_current_code' => '2',
                'q_51_social_smiling_most_abnormal_code' => '3',
                'q_52_show_direct_atten_current_code' => '2',
                'q_52_show_direct_atten_most_abnormal_code' => '3',
                'q_53_offer_share_current_code' => '2',
                'q_53_offer_share_most_abnormal_code' => '2',
                'q_54_seek_share_enjoy_current_code' => '2',
                'q_54_seek_share_enjoy_most_abnormal_code' => '2',
                'q_55_offer_comf_current_code' => '1',
                'q_55_offer_comf_most_abnormal_code' => '1',
                'q_56_qual_social_overts_current_code' => '2',
                'q_56_qual_social_overts_most_abnormal_code' => '2',
                'q_57_range_facial_expr_current_code' => '2',
                'q_57_range_facial_expr_most_abnormal_code' => '2',
                'q_58_inappropriate_facial_current_code' => '2',
                'q_58_inappropriate_facial_ever_code' => '2',
                'q_59_appropriat_resp_current_code' => '1',
                'q_59_appropriat_resp_most_abnormal_code' => '1',
                'q_60_init_activities_current_code' => '1',
                'q_60_init_activities_most_abnormal_code' => '3',
                'q_61_imit_soc_play_current_code' => '1',
                'q_61_imit_soc_play_most_abnormal_code' => '2',
                'q_62_inter_children_current_code' => '0',
                'q_62_inter_children_most_abnormal_code' => '1',
                'q_63_resp_approaches_current_code' => '1',
                'q_63_resp_approaches_most_abnormal_code' => '2',
                'q_64_group_play_peers_current_code' => '2',
                'q_64_group_play_peers_most_abnormal_code' => '2',
                'q_65_friendships_current_code' => '3',
                'q_65_friendships_most_abnormal_code' => '8',
                'q_66_soc_disinhibit_current_code' => '2',
                'q_66_soc_disinhibit_most_abnormal_code' => '2',
                'q_67_unusual_preoccupations_current_code' => '2',
                'q_67_unusual_preoccupations_ever_code' => '2',
                'q_68_circumscr_ints_current_code' => '3',
                'q_68_circumscr_ints_ever_code' => '3',
                'q_69_repet_use_objects_current_code' => '2',
                'q_69_repet_use_objects_ever_code' => '2',
                'q_70_compulsions_rituals_current_code' => '2',
                'q_70_compulsions_rituals_ever_code' => '2',
                'q_71_unusual_sens_ints_current_code' => '1',
                'q_71_unusual_sens_ints_ever_code' => '1',
                'q_72_undo_gen_sens_noise_current_code' => '2',
                'q_72_undo_gen_sens_noise_ever_code' => '2',
                'q_73_idiosyncratic_current_code' => '0',
                'q_73_idiosyncratic_ever_code' => '0',
                'q_74_diff_minor_changes_current_code' => '0',
                'q_74_diff_minor_changes_ever_code' => '0',
                'q_75_resist_trivial_chng_current_code' => '0',
                'q_75_resist_trivial_chng_ever_code' => '0',
                'q_76_unus_attach_objects_current_code' => '0',
                'q_76_unus_attach_objects_ever_code' => '0',
                'q_77_hands_finger_manners_current_code' => '2',
                'q_77_hands_finger_manners_ever_code' => '2',
                'q_78_oth_complex_manners_current_code' => '1',
                'q_78_oth_complex_manners_ever_code' => '2',
                'q_79_midline_hand_moves_current_code' => '0',
                'q_79_midline_hand_moves_ever_code' => '0',
                'q_80_gait_current_code' => '2',
                'q_80_gait_most_abnormal_code' => '2',
                'q_81_aggress_caregivers_current_code' => '2',
                'q_81_aggress_caregivers_ever_code' => '2',
                'q_82_aggress_noncaregivers_current_code' => '2',
                'q_82_aggress_noncaregivers_ever_code' => '2',
                'q_83_self_injury_current_code' => '0',
                'q_83_self_injury_ever_code' => '0',
                'q_84_hyperventilation_current_code' => '1',
                'q_84_hyperventilation_ever_code' => '1',
                'q_85_faints_fits_blackouts_current_code' => '0',
                'q_85_faints_fits_blackouts_ever_code' => '0',
                'q_86_age_when_abnormality_first_evident' => '4',
                'q_87_interviewers_judgment' => '19',
                'q_88_visuospatial_ability_current_code' => '7',
                'q_88_visuospatial_ability_ever_code' => '7',
                'q_89_memory_still_current_code' => '7',
                'q_89_memory_still_ever_code' => '7',
                'q_90_musical_ability_current_code' => '0',
                'q_90_musical_ability_ever_code' => '0',
                'q_91_drawings_skill_current_code' => '0',
                'q_91_drawings_skill_ever_code' => '0',
                'q_92_reading_ability_current_code' => '2',
                'q_92_reading_ability_ever_code' => '2',
                'q_93_computational_ability_current_code' => '0',
                'q_93_computational_ability_ever_code' => '0',
                'subject_verbal' => 'no'
            )
        );
        $this->assertEqual($ndar->process($FakeRows), $FakeResults);
    }

    function testWriteResults() {
        $ndar = new NDAR_Release('adi_r_proband');
        $fd = $ndar->writeResults(
            array(0 => array('abc' => '1', 'def' => 'fff'), 1=> array('abc' => '2', 'def' => 'gggf')), 
            'php://temp');
        $this->assertIsA($fd, 'Resource');
        rewind($fd);
        $contents = stream_get_contents($fd);
        $this->assertEqual($contents, "abc,def\n1,fff\n2,gggf\n");


    }
}
